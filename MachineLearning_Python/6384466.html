
<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>常用模块 - linhaifeng - 博客园</title>
<link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=-hy83QNg62d4qYibixJzxMJkbf1P9fTBlqv7SK5zVL01"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/MountainInk/bundle-MountainInk.css?v=HBGibhyLLV8mQnQReVubX6-F2k_BiB7Ei8bEthXTpWA1"/>
<link type="text/css" rel="stylesheet" href="/blog/customcss/309331.css?v=O3%2fa4e%2f4aaZ2pltKSUi9YKPFbhk%3d"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/MountainInk/bundle-MountainInk-mobile.css?v=d9LctKHRIQp9rreugMcQ1-UJuq_j1fo0GZXTXj8Bqrk1"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/linhaifeng/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/linhaifeng/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/linhaifeng/wlwmanifest.xml"/>
<script src="//common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
<script type="text/javascript">var currentBlogApp = 'linhaifeng', cb_enable_mathjax=false;var isLogined=false;</script>
<script src="/bundles/blog-common.js?v=O-NTEmnhjbG7lSYLc3yeqkrVxfMJyY9iXf4xyjlKikw1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="http://www.cnblogs.com/linhaifeng/"><img id="blogLogo" src="/Skins/custom/images/logo.gif" alt="返回主页" /></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/linhaifeng/">吾日三洗吾身，洗头、洗脸、洗身体</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/linhaifeng/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/linhaifeng">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="http://www.cnblogs.com/linhaifeng/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="http://www.cnblogs.com/linhaifeng/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 29&nbsp; </span>
<span id="stats_article_count">文章 - 85&nbsp; </span>
<span id="stats-comment_count">评论 - 76</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/linhaifeng/articles/6384466.html">常用模块</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><h1 id="三种时间表示">一 time与datetime模块</h1>
<p>在Python中，通常有这几种方式来表示时间：</p>
<ul>
<li>时间戳(timestamp)：通常来说，时间戳表示的是从1970年1月1日00:00:00开始按秒计算的偏移量。我们运行&ldquo;type(time.time())&rdquo;，返回的是float类型。</li>
<li>格式化的时间字符串(Format String)</li>
<li>结构化的时间(struct_time)：struct_time元组共有9个元素共九个元素:(年，月，日，时，分，秒，一年中第几周，一年中第几天，夏令时)</li>
</ul>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> time
</span><span style="color: #008080;">2</span> <span style="color: #008000;">#</span><span style="color: #008000;">--------------------------我们先以当前时间为准,让大家快速认识三种形式的时间</span>
<span style="color: #008080;">3</span> <span style="color: #0000ff;">print</span>(time.time()) <span style="color: #008000;">#</span><span style="color: #008000;"> 时间戳:1487130156.419527</span>
<span style="color: #008080;">4</span> <span style="color: #0000ff;">print</span>(time.strftime(<span style="color: #800000;">"</span><span style="color: #800000;">%Y-%m-%d %X</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">格式化的时间字符串:'2017-02-15 11:40:53'</span>
<span style="color: #008080;">5</span> 
<span style="color: #008080;">6</span> <span style="color: #0000ff;">print</span>(time.localtime()) <span style="color: #008000;">#</span><span style="color: #008000;">本地时区的struct_time</span>
<span style="color: #008080;">7</span> <span style="color: #0000ff;">print</span>(time.gmtime())    <span style="color: #008000;">#</span><span style="color: #008000;">UTC时区的struct_time</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('f91f7774-f57d-4b8f-ab3a-30d1be2ed577')"><img id="code_img_closed_f91f7774-f57d-4b8f-ab3a-30d1be2ed577" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_f91f7774-f57d-4b8f-ab3a-30d1be2ed577" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f91f7774-f57d-4b8f-ab3a-30d1be2ed577',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_f91f7774-f57d-4b8f-ab3a-30d1be2ed577" class="cnblogs_code_hide">
<pre>%<span style="color: #000000;">a    Locale&rsquo;s abbreviated weekday name.     
</span>%<span style="color: #000000;">A    Locale&rsquo;s full weekday name.     
</span>%<span style="color: #000000;">b    Locale&rsquo;s abbreviated month name.     
</span>%<span style="color: #000000;">B    Locale&rsquo;s full month name.     
</span>%c    Locale&rsquo;s appropriate date <span style="color: #0000ff;">and</span><span style="color: #000000;"> time representation.     
</span>%d    Day of the month as a decimal number [01,31<span style="color: #000000;">].     
</span>%H    Hour (24-hour clock) as a decimal number [00,23<span style="color: #000000;">].     
</span>%I    Hour (12-hour clock) as a decimal number [01,12<span style="color: #000000;">].     
</span>%j    Day of the year as a decimal number [001,366<span style="color: #000000;">].     
</span>%m    Month as a decimal number [01,12<span style="color: #000000;">].     
</span>%M    Minute as a decimal number [00,59<span style="color: #000000;">].     
</span>%p    Locale&rsquo;s equivalent of either AM <span style="color: #0000ff;">or</span> PM.    (1<span style="color: #000000;">)
</span>%S    Second as a decimal number [00,61].    (2<span style="color: #000000;">)
</span>%U    Week number of the year (Sunday as the first day of the week) as a decimal number [00,53]. All days <span style="color: #0000ff;">in</span> a new year preceding the first Sunday are considered to be <span style="color: #0000ff;">in</span> week 0.    (3<span style="color: #000000;">)
</span>%w    Weekday as a decimal number [0(Sunday),6<span style="color: #000000;">].     
</span>%W    Week number of the year (Monday as the first day of the week) as a decimal number [00,53]. All days <span style="color: #0000ff;">in</span> a new year preceding the first Monday are considered to be <span style="color: #0000ff;">in</span> week 0.    (3<span style="color: #000000;">)
</span>%<span style="color: #000000;">x    Locale&rsquo;s appropriate date representation.     
</span>%<span style="color: #000000;">X    Locale&rsquo;s appropriate time representation.     
</span>%y    Year without century as a decimal number [00,99<span style="color: #000000;">].     
</span>%<span style="color: #000000;">Y    Year with century as a decimal number.     
</span>%z    Time zone offset indicating a positive <span style="color: #0000ff;">or</span> negative time difference <span style="color: #0000ff;">from</span> UTC/GMT of the form +HHMM <span style="color: #0000ff;">or</span> -HHMM, where H represents decimal hour digits <span style="color: #0000ff;">and</span> M represents decimal minute digits [-23:59, +23:59<span style="color: #000000;">].     
</span>%Z    Time zone name (no characters <span style="color: #0000ff;">if</span><span style="color: #000000;"> no time zone exists).     
</span>%%    A literal <span style="color: #800000;">'</span><span style="color: #800000;">%</span><span style="color: #800000;">'</span> character.</pre>
</div>
<span class="cnblogs_code_collapse">格式化字符串的时间格式</span></div>
<p>&nbsp;</p>
<p>其中计算机认识的时间只能是'时间戳'格式，而程序员可处理的或者说人类能看懂的时间有: '格式化的时间字符串'，'结构化的时间'&nbsp;，于是有了下图的转换关系</p>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201702/1036857-20170215142700722-743334012.png" alt="" /></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;">--------------------------按图1转换时间</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">#</span><span style="color: #008000;"> localtime([secs])</span>
<span style="color: #008080;"> 3</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 将一个时间戳转换为当前时区的struct_time。secs参数未提供，则以当前时间为准。</span>
<span style="color: #008080;"> 4</span> <span style="color: #000000;">time.localtime()
</span><span style="color: #008080;"> 5</span> time.localtime(1473525444.037215<span style="color: #000000;">)
</span><span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #008000;">#</span><span style="color: #008000;"> gmtime([secs]) 和localtime()方法类似，gmtime()方法是将一个时间戳转换为UTC时区（0时区）的struct_time。</span>
<span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #008000;">#</span><span style="color: #008000;"> mktime(t) : 将一个struct_time转化为时间戳。</span>
<span style="color: #008080;">10</span> <span style="color: #0000ff;">print</span>(time.mktime(time.localtime()))<span style="color: #008000;">#</span><span style="color: #008000;">1473525749.0</span>
<span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #008000;">#</span><span style="color: #008000;"> strftime(format[, t]) : 把一个代表时间的元组或者struct_time（如由time.localtime()和</span>
<span style="color: #008080;">14</span> <span style="color: #008000;">#</span><span style="color: #008000;"> time.gmtime()返回）转化为格式化的时间字符串。如果t未指定，将传入time.localtime()。如果元组中任何一个</span>
<span style="color: #008080;">15</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 元素越界，ValueError的错误将会被抛出。</span>
<span style="color: #008080;">16</span> <span style="color: #0000ff;">print</span>(time.strftime(<span style="color: #800000;">"</span><span style="color: #800000;">%Y-%m-%d %X</span><span style="color: #800000;">"</span>, time.localtime()))<span style="color: #008000;">#</span><span style="color: #008000;">2016-09-11 00:49:56</span>
<span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #008000;">#</span><span style="color: #008000;"> time.strptime(string[, format])</span>
<span style="color: #008080;">19</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 把一个格式化时间字符串转化为struct_time。实际上它和strftime()是逆操作。</span>
<span style="color: #008080;">20</span> <span style="color: #0000ff;">print</span>(time.strptime(<span style="color: #800000;">'</span><span style="color: #800000;">2011-05-05 16:37:06</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %X</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">21</span> <span style="color: #008000;">#</span><span style="color: #008000;">time.struct_time(tm_year=2011, tm_mon=5, tm_mday=5, tm_hour=16, tm_min=37, tm_sec=6,</span>
<span style="color: #008080;">22</span> <span style="color: #008000;">#</span><span style="color: #008000;">  tm_wday=3, tm_yday=125, tm_isdst=-1)</span>
<span style="color: #008080;">23</span> <span style="color: #008000;">#</span><span style="color: #008000;">在这个函数中，format默认为："%a %b %d %H:%M:%S %Y"。</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201702/1036857-20170215143428754-2105818567.png" alt="" /></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #008000;">#</span><span style="color: #008000;">--------------------------按图2转换时间</span>
<span style="color: #008080;">2</span> <span style="color: #008000;">#</span><span style="color: #008000;"> asctime([t]) : 把一个表示时间的元组或者struct_time表示为这种形式：'Sun Jun 20 23:21:05 1993'。</span>
<span style="color: #008080;">3</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 如果没有参数，将会将time.localtime()作为参数传入。</span>
<span style="color: #008080;">4</span> <span style="color: #0000ff;">print</span>(time.asctime())<span style="color: #008000;">#</span><span style="color: #008000;">Sun Sep 11 00:43:43 2016</span>
<span style="color: #008080;">5</span> 
<span style="color: #008080;">6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> ctime([secs]) : 把一个时间戳（按秒计算的浮点数）转化为time.asctime()的形式。如果参数未给或者为</span>
<span style="color: #008080;">7</span> <span style="color: #008000;">#</span><span style="color: #008000;"> None的时候，将会默认time.time()为参数。它的作用相当于time.asctime(time.localtime(secs))。</span>
<span style="color: #008080;">8</span> <span style="color: #0000ff;">print</span>(time.ctime())  <span style="color: #008000;">#</span><span style="color: #008000;"> Sun Sep 11 00:46:38 2016</span>
<span style="color: #008080;">9</span> <span style="color: #0000ff;">print</span>(time.ctime(time.time()))  <span style="color: #008000;">#</span><span style="color: #008000;"> Sun Sep 11 00:46:38 2016</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #008000;">#</span><span style="color: #008000;">--------------------------其他用法</span>
<span style="color: #008080;">2</span> <span style="color: #008000;">#</span><span style="color: #008000;"> sleep(secs)</span>
<span style="color: #008080;">3</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 线程推迟指定的时间运行，单位为秒。</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('4651629d-79b2-4a79-9053-78901592416d')"><img id="code_img_closed_4651629d-79b2-4a79-9053-78901592416d" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_4651629d-79b2-4a79-9053-78901592416d" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('4651629d-79b2-4a79-9053-78901592416d',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_4651629d-79b2-4a79-9053-78901592416d" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">时间加减</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> datetime

</span><span style="color: #008000;">#</span><span style="color: #008000;"> print(datetime.datetime.now()) #返回 2016-08-19 12:47:03.941925</span><span style="color: #008000;">
#</span><span style="color: #008000;">print(datetime.date.fromtimestamp(time.time()) )  # 时间戳直接转成日期格式 2016-08-19</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(datetime.datetime.now() )</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(datetime.datetime.now() + datetime.timedelta(3)) #当前时间+3天</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(datetime.datetime.now() + datetime.timedelta(-3)) #当前时间-3天</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(datetime.datetime.now() + datetime.timedelta(hours=3)) #当前时间+3小时</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(datetime.datetime.now() + datetime.timedelta(minutes=30)) #当前时间+30分</span>


<span style="color: #008000;">#
#</span><span style="color: #008000;"> c_time  = datetime.datetime.now()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(c_time.replace(minute=3,hour=2)) #时间替换</span></pre>
</div>
<span class="cnblogs_code_collapse">datetime模块</span></div>
<h1>二 random模块</h1>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> random
</span><span style="color: #008080;"> 2</span>  
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">print</span>(random.random())<span style="color: #008000;">#</span><span style="color: #008000;">(0,1)----float    大于0且小于1之间的小数</span>
<span style="color: #008080;"> 4</span>  
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">print</span>(random.randint(1,3))  <span style="color: #008000;">#</span><span style="color: #008000;">[1,3]    大于等于1且小于等于3之间的整数</span>
<span style="color: #008080;"> 6</span>  
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">print</span>(random.randrange(1,3)) <span style="color: #008000;">#</span><span style="color: #008000;">[1,3)    大于等于1且小于3之间的整数</span>
<span style="color: #008080;"> 8</span>  
<span style="color: #008080;"> 9</span> <span style="color: #0000ff;">print</span>(random.choice([1,<span style="color: #800000;">'</span><span style="color: #800000;">23</span><span style="color: #800000;">'</span>,[4,5]]))<span style="color: #008000;">#1或者</span><span style="color: #008000;">23或者[4,5]</span>
<span style="color: #008080;">10</span>  
<span style="color: #008080;">11</span> <span style="color: #0000ff;">print</span>(random.sample([1,<span style="color: #800000;">'</span><span style="color: #800000;">23</span><span style="color: #800000;">'</span>,[4,5]],2))<span style="color: #008000;">#列表元素任意2个组合</span>
<span style="color: #008080;">12</span>  
<span style="color: #008080;">13</span> <span style="color: #0000ff;">print</span>(random.uniform(1,3))<span style="color: #008000;">#大于1小于3的小数，如</span><span style="color: #008000;">1.927109612082716 </span>
<span style="color: #008080;">14</span>  
<span style="color: #008080;">15</span>  
<span style="color: #008080;">16</span> item=[1,3,5,7,9<span style="color: #000000;">]
</span><span style="color: #008080;">17</span> <span style="color: #000000;">random.shuffle(item) #打乱item的顺序,相当于"洗牌"
</span><span style="color: #008080;">18</span> <span style="color: #0000ff;">print</span>(item)</pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('764249a5-87e9-4e2d-9445-a035cbe280aa')"><img id="code_img_closed_764249a5-87e9-4e2d-9445-a035cbe280aa" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_764249a5-87e9-4e2d-9445-a035cbe280aa" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('764249a5-87e9-4e2d-9445-a035cbe280aa',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_764249a5-87e9-4e2d-9445-a035cbe280aa" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> random
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> make_code(n):
    res</span>=<span style="color: #800000;">''</span>
    <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(n):
        s1</span>=chr(random.randint(65,90<span style="color: #000000;">))
        s2</span>=str(random.randint(0,9<span style="color: #000000;">))
        res</span>+=<span style="color: #000000;">random.choice([s1,s2])
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> res

</span><span style="color: #0000ff;">print</span>(make_code(9))</pre>
</div>
<span class="cnblogs_code_collapse">生成随机验证码</span></div>
<h1>三 os模块</h1>
<p>os模块是与操作系统交互的一个接口</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('8eebad32-cc8a-406b-9027-9c9c35abe356')"><img id="code_img_closed_8eebad32-cc8a-406b-9027-9c9c35abe356" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_8eebad32-cc8a-406b-9027-9c9c35abe356" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8eebad32-cc8a-406b-9027-9c9c35abe356',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_8eebad32-cc8a-406b-9027-9c9c35abe356" class="cnblogs_code_hide">
<pre><span style="color: #000000;">os.getcwd() 获取当前工作目录，即当前python脚本工作的目录路径
os.chdir(</span><span style="color: #800000;">"</span><span style="color: #800000;">dirname</span><span style="color: #800000;">"</span><span style="color: #000000;">)  改变当前脚本工作目录；相当于shell下cd
os.curdir  返回当前目录: (</span><span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span><span style="color: #000000;">)
os.pardir  获取当前目录的父目录字符串名：(</span><span style="color: #800000;">'</span><span style="color: #800000;">..</span><span style="color: #800000;">'</span><span style="color: #000000;">)
os.makedirs(</span><span style="color: #800000;">'</span><span style="color: #800000;">dirname1/dirname2</span><span style="color: #800000;">'</span><span style="color: #000000;">)    可生成多层递归目录
os.removedirs(</span><span style="color: #800000;">'</span><span style="color: #800000;">dirname1</span><span style="color: #800000;">'</span><span style="color: #000000;">)    若目录为空，则删除，并递归到上一级目录，如若也为空，则删除，依此类推
os.mkdir(</span><span style="color: #800000;">'</span><span style="color: #800000;">dirname</span><span style="color: #800000;">'</span><span style="color: #000000;">)    生成单级目录；相当于shell中mkdir dirname
os.rmdir(</span><span style="color: #800000;">'</span><span style="color: #800000;">dirname</span><span style="color: #800000;">'</span><span style="color: #000000;">)    删除单级空目录，若目录不为空则无法删除，报错；相当于shell中rmdir dirname
os.listdir(</span><span style="color: #800000;">'</span><span style="color: #800000;">dirname</span><span style="color: #800000;">'</span><span style="color: #000000;">)    列出指定目录下的所有文件和子目录，包括隐藏文件，并以列表方式打印
os.remove()  删除一个文件
os.rename(</span><span style="color: #800000;">"</span><span style="color: #800000;">oldname</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">newname</span><span style="color: #800000;">"</span>)  重命名文件/<span style="color: #000000;">目录
os.stat(</span><span style="color: #800000;">'</span><span style="color: #800000;">path/filename</span><span style="color: #800000;">'</span>)  获取文件/<span style="color: #000000;">目录信息
os.sep    输出操作系统特定的路径分隔符，win下为</span><span style="color: #800000;">"</span><span style="color: #800000;">\\</span><span style="color: #800000;">"</span>,Linux下为<span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">
os.linesep    输出当前平台使用的行终止符，win下为</span><span style="color: #800000;">"</span><span style="color: #800000;">\t\n</span><span style="color: #800000;">"</span>,Linux下为<span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span><span style="color: #000000;">
os.pathsep    输出用于分割文件路径的字符串 win下为;,Linux下为:
os.name    输出字符串指示当前使用平台。win</span>-&gt;<span style="color: #800000;">'</span><span style="color: #800000;">nt</span><span style="color: #800000;">'</span>; Linux-&gt;<span style="color: #800000;">'</span><span style="color: #800000;">posix</span><span style="color: #800000;">'</span><span style="color: #000000;">
os.system(</span><span style="color: #800000;">"</span><span style="color: #800000;">bash command</span><span style="color: #800000;">"</span><span style="color: #000000;">)  运行shell命令，直接显示
os.environ  获取系统环境变量
os.path.abspath(path)  返回path规范化的绝对路径
os.path.split(path)  将path分割成目录和文件名二元组返回
os.path.dirname(path)  返回path的目录。其实就是os.path.split(path)的第一个元素
os.path.basename(path)  返回path最后的文件名。如何path以／或\结尾，那么就会返回空值。即os.path.split(path)的第二个元素
os.path.exists(path)  如果path存在，返回True；如果path不存在，返回False
os.path.isabs(path)  如果path是绝对路径，返回True
os.path.isfile(path)  如果path是一个存在的文件，返回True。否则返回False
os.path.isdir(path)  如果path是一个存在的目录，则返回True。否则返回False
os.path.join(path1[, path2[, ...]])  将多个路径组合后返回，第一个绝对路径之前的参数将被忽略
os.path.getatime(path)  返回path所指向的文件或者目录的最后存取时间
os.path.getmtime(path)  返回path所指向的文件或者目录的最后修改时间
os.path.getsize(path) 返回path的大小</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">在Linux和Mac平台上，该函数会原样返回path，在windows平台上会将路径中所有字符转换为小写，并将所有斜杠转换为饭斜杠。
</span>&gt;&gt;&gt; os.path.normcase(<span style="color: #800000;">'</span><span style="color: #800000;">c:/windows\\system32\\</span><span style="color: #800000;">'</span><span style="color: #000000;">)   
</span><span style="color: #800000;">'</span><span style="color: #800000;">c:\\windows\\system32\\</span><span style="color: #800000;">'</span><span style="color: #000000;">   
   

规范化路径，如..和</span>/
&gt;&gt;&gt; os.path.normpath(<span style="color: #800000;">'</span><span style="color: #800000;">c://windows\\System32\\../Temp/</span><span style="color: #800000;">'</span><span style="color: #000000;">)   
</span><span style="color: #800000;">'</span><span style="color: #800000;">c:\\windows\\Temp</span><span style="color: #800000;">'</span>   

&gt;&gt;&gt; a=<span style="color: #800000;">'</span><span style="color: #800000;">/Users/jieli/test1/\\\a1/\\\\aa.py/../..</span><span style="color: #800000;">'</span>
&gt;&gt;&gt; <span style="color: #0000ff;">print</span><span style="color: #000000;">(os.path.normpath(a))
</span>/Users/jieli/test1</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">os路径处理
</span><span style="color: #008000;">#</span><span style="color: #008000;">方式一：推荐使用</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> os
</span><span style="color: #008000;">#</span><span style="color: #008000;">具体应用</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> os,sys
possible_topdir </span>=<span style="color: #000000;"> os.path.normpath(os.path.join(
    os.path.abspath(</span><span style="color: #800080;">__file__</span><span style="color: #000000;">),
    os.pardir, </span><span style="color: #008000;">#</span><span style="color: #008000;">上一级</span>
<span style="color: #000000;">    os.pardir,
    os.pardir
))
sys.path.insert(0,possible_topdir)


</span><span style="color: #008000;">#</span><span style="color: #008000;">方式二：不推荐使用</span>
os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(<span style="color: #800080;">__file__</span>))))</pre>
</div>
<h1>四 sys模块</h1>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">sys.argv           命令行参数List，第一个元素是程序本身路径
</span><span style="color: #008080;">2</span> <span style="color: #000000;">sys.exit(n)        退出程序，正常退出时exit(0)
</span><span style="color: #008080;">3</span> <span style="color: #000000;">sys.version        获取Python解释程序的版本信息
</span><span style="color: #008080;">4</span> <span style="color: #000000;">sys.maxint         最大的Int值
</span><span style="color: #008080;">5</span> <span style="color: #000000;">sys.path           返回模块的搜索路径，初始化时使用PYTHONPATH环境变量的值
</span><span style="color: #008080;">6</span> sys.platform       返回操作系统平台名称</pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('2ad721d1-31d9-40c6-8be4-b42a6cbc087a')"><img id="code_img_closed_2ad721d1-31d9-40c6-8be4-b42a6cbc087a" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_2ad721d1-31d9-40c6-8be4-b42a6cbc087a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2ad721d1-31d9-40c6-8be4-b42a6cbc087a',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_2ad721d1-31d9-40c6-8be4-b42a6cbc087a" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">=========知识储备==========</span><span style="color: #008000;">
#</span><span style="color: #008000;">进度条的效果</span>
[<span style="color: #008000;">#</span><span style="color: #008000;">             ]</span>
[<span style="color: #008000;">#</span><span style="color: #008000;">#            ]</span>
[<span style="color: #008000;">#</span><span style="color: #008000;">##           ]</span>
[<span style="color: #008000;">#</span><span style="color: #008000;">###          ]</span>

<span style="color: #008000;">#</span><span style="color: #008000;">指定宽度</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">[%-15s]</span><span style="color: #800000;">'</span> %<span style="color: #800000;">'</span><span style="color: #800000;">#</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">[%-15s]</span><span style="color: #800000;">'</span> %<span style="color: #800000;">'</span><span style="color: #800000;">##</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">[%-15s]</span><span style="color: #800000;">'</span> %<span style="color: #800000;">'</span><span style="color: #800000;">###</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">[%-15s]</span><span style="color: #800000;">'</span> %<span style="color: #800000;">'</span><span style="color: #800000;">####</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">打印%</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">%s%%</span><span style="color: #800000;">'</span> %(100)) <span style="color: #008000;">#</span><span style="color: #008000;">第二个%号代表取消第一个%的特殊意义</span>

<span style="color: #008000;">#</span><span style="color: #008000;">可传参来控制宽度</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">[%%-%ds]</span><span style="color: #800000;">'</span> %50) <span style="color: #008000;">#</span><span style="color: #008000;">[%-50s]</span>
<span style="color: #0000ff;">print</span>((<span style="color: #800000;">'</span><span style="color: #800000;">[%%-%ds]</span><span style="color: #800000;">'</span> %50) %<span style="color: #800000;">'</span><span style="color: #800000;">#</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>((<span style="color: #800000;">'</span><span style="color: #800000;">[%%-%ds]</span><span style="color: #800000;">'</span> %50) %<span style="color: #800000;">'</span><span style="color: #800000;">##</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>((<span style="color: #800000;">'</span><span style="color: #800000;">[%%-%ds]</span><span style="color: #800000;">'</span> %50) %<span style="color: #800000;">'</span><span style="color: #800000;">###</span><span style="color: #800000;">'</span><span style="color: #000000;">)


</span><span style="color: #008000;">#</span><span style="color: #008000;">=========实现打印进度条函数==========</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> sys
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> time

</span><span style="color: #0000ff;">def</span> progress(percent,width=50<span style="color: #000000;">):
    </span><span style="color: #0000ff;">if</span> percent &gt;= 1<span style="color: #000000;">:
        percent</span>=1<span style="color: #000000;">
    show_str</span>=(<span style="color: #800000;">'</span><span style="color: #800000;">[%%-%ds]</span><span style="color: #800000;">'</span> %width) %(int(width*percent)*<span style="color: #800000;">'</span><span style="color: #800000;">#</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">\r%s %d%%</span><span style="color: #800000;">'</span> %(show_str,int(100*percent)),file=sys.stdout,flush=True,end=<span style="color: #800000;">''</span><span style="color: #000000;">)


</span><span style="color: #008000;">#</span><span style="color: #008000;">=========应用==========</span>
data_size=1025<span style="color: #000000;">
recv_size</span>=<span style="color: #000000;">0
</span><span style="color: #0000ff;">while</span> recv_size &lt;<span style="color: #000000;"> data_size:
    time.sleep(</span>0.1) <span style="color: #008000;">#</span><span style="color: #008000;">模拟数据的传输延迟</span>
    recv_size+=1024 <span style="color: #008000;">#</span><span style="color: #008000;">每次收1024</span>
<span style="color: #000000;">
    percent</span>=recv_size/data_size <span style="color: #008000;">#</span><span style="color: #008000;">接收的比例</span>
    progress(percent,width=70) <span style="color: #008000;">#</span><span style="color: #008000;">进度条的宽度70</span></pre>
</div>
<span class="cnblogs_code_collapse">打印进度条</span></div>
<h1>五 shutil模块</h1>
<p>高级的 文件、文件夹、压缩包 处理模块</p>
<p><strong>shutil.copyfileobj(fsrc, fdst[, length])</strong><br />将文件内容拷贝到另一个文件中</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.copyfileobj(open(<span style="color: #800000;">'</span><span style="color: #800000;">old.xml</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span>), open(<span style="color: #800000;">'</span><span style="color: #800000;">new.xml</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span>))</pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.copyfile(src, dst)</strong><br />拷贝文件</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> shutil.copyfile(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">目标文件无需存在</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.copymode(src, dst)</strong><br />仅拷贝权限。内容、组、用户均不变</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> shutil.copymode(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">目标文件必须存在</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.copystat(src, dst)</strong><br />仅拷贝状态的信息，包括：mode bits, atime, mtime, flags</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> shutil.copystat(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">目标文件必须存在</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.copy(src, dst)</strong><br />拷贝文件和权限</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.copy(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.copy2(src, dst)</strong><br />拷贝文件和状态信息</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.copy2(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.ignore_patterns(*patterns)</strong><br /><strong>shutil.copytree(src, dst, symlinks=False, ignore=None)</strong><br />递归的去拷贝文件夹</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.copytree(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">folder2</span><span style="color: #800000;">'</span>, ignore=shutil.ignore_patterns(<span style="color: #800000;">'</span><span style="color: #800000;">*.pyc</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">tmp*</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">目标目录不能存在，注意对folder2目录父级目录要有可写权限，ignore的意思是排除</span>&nbsp;</pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('7bea2ebf-0dd1-41ca-afe5-a56868e5a4a0')"><img id="code_img_closed_7bea2ebf-0dd1-41ca-afe5-a56868e5a4a0" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_7bea2ebf-0dd1-41ca-afe5-a56868e5a4a0" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('7bea2ebf-0dd1-41ca-afe5-a56868e5a4a0',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_7bea2ebf-0dd1-41ca-afe5-a56868e5a4a0" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil

shutil.copytree(</span><span style="color: #800000;">'</span><span style="color: #800000;">f1</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">f2</span><span style="color: #800000;">'</span>, symlinks=True, ignore=shutil.ignore_patterns(<span style="color: #800000;">'</span><span style="color: #800000;">*.pyc</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">tmp*</span><span style="color: #800000;">'</span><span style="color: #000000;">))

</span><span style="color: #800000;">'''</span><span style="color: #800000;">
通常的拷贝都把软连接拷贝成硬链接，即对待软连接来说，创建新的文件
</span><span style="color: #800000;">'''</span></pre>
</div>
<span class="cnblogs_code_collapse">拷贝软连接</span></div>
<p>&nbsp;</p>
<p><strong>shutil.rmtree(path[, ignore_errors[, onerror]])</strong><br />递归的去删除文件</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.rmtree(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.move(src, dst)</strong><br />递归的去移动文件，它类似mv命令，其实就是重命名。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> shutil.move(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">folder3</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p><strong>shutil.make_archive(base_name, format,...)</strong></p>
<p>创建压缩包并返回文件路径，例如：zip、tar</p>
<p>创建压缩包并返回文件路径，例如：zip、tar</p>
<ul>
<li>base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，<br />如 data_bak &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt;保存至当前路径<br />如：/tmp/data_bak =&gt;保存至/tmp/</li>
<li>format：	压缩包种类，&ldquo;zip&rdquo;, &ldquo;tar&rdquo;, &ldquo;bztar&rdquo;，&ldquo;gztar&rdquo;</li>
<li>root_dir：	要压缩的文件夹路径（默认当前目录）</li>
<li>owner：	用户，默认当前用户</li>
<li>group：	组，默认当前组</li>
<li>logger：	用于记录日志，通常是logging.Logger对象</li>









































































































































































































</ul>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #008000;">#</span><span style="color: #008000;">将 /data 下的文件打包放置当前程序目录</span>
<span style="color: #008080;">2</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">3</span> ret = shutil.make_archive(<span style="color: #800000;">"</span><span style="color: #800000;">data_bak</span><span style="color: #800000;">"</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gztar</span><span style="color: #800000;">'</span>, root_dir=<span style="color: #800000;">'</span><span style="color: #800000;">/data</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">4</span>   
<span style="color: #008080;">5</span>   
<span style="color: #008080;">6</span> <span style="color: #008000;">#</span><span style="color: #008000;">将 /data下的文件打包放置 /tmp/目录</span>
<span style="color: #008080;">7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
</span><span style="color: #008080;">8</span> ret = shutil.make_archive(<span style="color: #800000;">"</span><span style="color: #800000;">/tmp/data_bak</span><span style="color: #800000;">"</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gztar</span><span style="color: #800000;">'</span>, root_dir=<span style="color: #800000;">'</span><span style="color: #800000;">/data</span><span style="color: #800000;">'</span>)<span style="font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 1.5; background-color: #ffffff;">&nbsp;</span></pre>
</div>
<p>shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('0549d26f-e5fa-4365-8c89-0e1ab1c1d9b3')"><img id="code_img_closed_0549d26f-e5fa-4365-8c89-0e1ab1c1d9b3" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_0549d26f-e5fa-4365-8c89-0e1ab1c1d9b3" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('0549d26f-e5fa-4365-8c89-0e1ab1c1d9b3',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_0549d26f-e5fa-4365-8c89-0e1ab1c1d9b3" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> zipfile

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 压缩</span>
z = zipfile.ZipFile(<span style="color: #800000;">'</span><span style="color: #800000;">laxi.zip</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">a.log</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">data.data</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.close()

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 解压</span>
z = zipfile.ZipFile(<span style="color: #800000;">'</span><span style="color: #800000;">laxi.zip</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.extractall(path</span>=<span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.close()</span></pre>
</div>
<span class="cnblogs_code_collapse">zipfile压缩解压缩</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('184e4989-85bc-47d2-8f37-6cb06af98aa5')"><img id="code_img_closed_184e4989-85bc-47d2-8f37-6cb06af98aa5" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_184e4989-85bc-47d2-8f37-6cb06af98aa5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('184e4989-85bc-47d2-8f37-6cb06af98aa5',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_184e4989-85bc-47d2-8f37-6cb06af98aa5" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> tarfile

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 压缩</span>
&gt;&gt;&gt; t=tarfile.open(<span style="color: #800000;">'</span><span style="color: #800000;">/tmp/egon.tar</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span>&gt;&gt;&gt; t.add(<span style="color: #800000;">'</span><span style="color: #800000;">/test1/a.py</span><span style="color: #800000;">'</span>,arcname=<span style="color: #800000;">'</span><span style="color: #800000;">a.bak</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span>&gt;&gt;&gt; t.add(<span style="color: #800000;">'</span><span style="color: #800000;">/test1/b.py</span><span style="color: #800000;">'</span>,arcname=<span style="color: #800000;">'</span><span style="color: #800000;">b.bak</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span>&gt;&gt;&gt;<span style="color: #000000;"> t.close()


</span><span style="color: #008000;">#</span><span style="color: #008000;"> 解压</span>
&gt;&gt;&gt; t=tarfile.open(<span style="color: #800000;">'</span><span style="color: #800000;">/tmp/egon.tar</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span>&gt;&gt;&gt; t.extractall(<span style="color: #800000;">'</span><span style="color: #800000;">/egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span>&gt;&gt;&gt; t.close()</pre>
</div>
<span class="cnblogs_code_collapse">tarfile压缩解压缩</span></div>
<h1>六 json&amp;pickle模块</h1>
<p>之前我们学习过用eval内置方法可以将一个字符串转成python对象，不过，eval方法是有局限性的，对于普通的数据类型，json.loads和eval都能用，但遇到特殊类型的时候，eval就不管用了,所以eval的重点还是通常用来执行一个字符串表达式，并返回表达式的值。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> json
</span><span style="color: #008080;">2</span> x=<span style="color: #800000;">"</span><span style="color: #800000;">[null,true,false,1]</span><span style="color: #800000;">"</span>
<span style="color: #008080;">3</span> <span style="color: #0000ff;">print</span>(eval(x)) <span style="color: #008000;">#</span><span style="color: #008000;">报错，无法解析null类型，而json就可以</span>
<span style="color: #008080;">4</span> <span style="color: #0000ff;">print</span>(json.loads(x))<span style="font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 1.5; background-color: #ffffff;">&nbsp;</span></pre>
</div>
<p><span style="font-size: 14pt;"><strong>什么是序列化？</strong></span></p>
<p>我们把对象(变量)从内存中变成可存储或传输的过程称之为序列化，在Python中叫pickling，在其他语言中也被称之为serialization，marshalling，flattening等等，都是一个意思。</p>
<p><span style="font-size: 14pt;"><strong>为什么要序列化？</strong></span></p>
<p>1：持久保存状态</p>
<p>需知一个软件/程序的执行就在处理一系列状态的变化，在编程语言中，'状态'会以各种各样有结构的数据类型(也可简单的理解为变量)的形式被保存在内存中。</p>
<p>内存是无法永久保存数据的，当程序运行了一段时间，我们断电或者重启程序，内存中关于这个程序的之前一段时间的数据（有结构）都被清空了。</p>
<p>在断电或重启程序之前将程序当前内存中所有的数据都保存下来（保存到文件中），以便于下次程序执行能够从文件中载入之前的数据，然后继续执行，这就是序列化。</p>
<p><span style="line-height: 1.5;">具体的来说，你玩使命召唤闯到了第13关，你保存游戏状态，关机走人，下次再玩，还能从上次的位置开始继续闯关。或如，虚拟机状态的挂起等。</span></p>
<p><span style="line-height: 1.5;">2：跨平台数据交互</span></p>
<p>序列化之后，不仅可以把序列化后的内容写入磁盘，还可以通过网络传输到别的机器上，如果收发的双方约定好实用一种序列化的格式，那么便打破了平台/语言差异化带来的限制，实现了跨平台数据交互。</p>
<p>反过来，把变量内容从序列化的对象重新读到内存里称之为反序列化，即unpickling。</p>
<p><span style="font-size: 14pt;"><strong>如何序列化之json和pickle：</strong></span></p>
<p><span style="font-size: 14pt;"><strong>json</strong></span></p>
<p>如果我们要在不同的编程语言之间传递对象，就必须把对象序列化为标准格式，比如XML，但更好的方法是序列化为JSON，因为JSON表示出来就是一个字符串，可以被所有语言读取，也可以方便地存储到磁盘或者通过网络传输。JSON不仅是标准格式，并且比XML更快，而且可以直接在Web页面中读取，非常方便。</p>
<p>JSON表示的对象就是标准的JavaScript语言的对象，JSON和Python内置的数据类型对应如下：</p>
<p><img src="https://images2015.cnblogs.com/blog/877318/201609/877318-20160911105642628-530508765.png" alt="" width="586" height="190" /></p>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201702/1036857-20170215162939035-339680318.png" alt="" width="553" height="150" /></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> json
</span><span style="color: #008080;"> 2</span>  
<span style="color: #008080;"> 3</span> dic={<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">alvin</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>:23,<span style="color: #800000;">'</span><span style="color: #800000;">sex</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">male</span><span style="color: #800000;">'</span><span style="color: #000000;">}
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">print</span>(type(dic))<span style="color: #008000;">#</span><span style="color: #008000;">&lt;class 'dict'&gt;</span>
<span style="color: #008080;"> 5</span>  
<span style="color: #008080;"> 6</span> j=<span style="color: #000000;">json.dumps(dic)
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">print</span>(type(j))<span style="color: #008000;">#</span><span style="color: #008000;">&lt;class 'str'&gt;</span>
<span style="color: #008080;"> 8</span>  
<span style="color: #008080;"> 9</span>  
<span style="color: #008080;">10</span> f=open(<span style="color: #800000;">'</span><span style="color: #800000;">序列化对象</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">11</span> f.write(j)  <span style="color: #008000;">#</span><span style="color: #008000;">-------------------等价于json.dump(dic,f)</span>
<span style="color: #008080;">12</span> <span style="color: #000000;">f.close()
</span><span style="color: #008080;">13</span> <span style="color: #008000;">#</span><span style="color: #008000;">-----------------------------反序列化&lt;br&gt;</span>
<span style="color: #008080;">14</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> json
</span><span style="color: #008080;">15</span> f=open(<span style="color: #800000;">'</span><span style="color: #800000;">序列化对象</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">16</span> data=json.loads(f.read())<span style="color: #008000;">#</span><span style="color: #008000;">  等价于data=json.load(f)</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('676b544d-ad06-4471-856f-555845706328')"><img id="code_img_closed_676b544d-ad06-4471-856f-555845706328" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_676b544d-ad06-4471-856f-555845706328" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('676b544d-ad06-4471-856f-555845706328',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_676b544d-ad06-4471-856f-555845706328" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> json
</span><span style="color: #008000;">#</span><span style="color: #008000;">dct="{'1':111}"#json 不认单引号</span><span style="color: #008000;">
#</span><span style="color: #008000;">dct=str({"1":111})#报错,因为生成的数据还是单引号:{'one': 1}</span>
<span style="color: #000000;">
dct</span>=<span style="color: #800000;">'</span><span style="color: #800000;">{"1":"111"}</span><span style="color: #800000;">'</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(json.loads(dct))

</span><span style="color: #008000;">#</span><span style="color: #008000;">conclusion:</span><span style="color: #008000;">
#</span><span style="color: #008000;">        无论数据是怎样创建的，只要满足json格式，就可以json.loads出来,不一定非要dumps的数据才能loads</span></pre>
</div>
<span class="cnblogs_code_collapse"> 注意点</span></div>
<p><span style="font-size: 14pt;"><strong>pickle</strong></span></p>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201702/1036857-20170215164644722-1590025858.png" alt="" width="556" height="150" /></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> pickle
</span><span style="color: #008080;"> 2</span>  
<span style="color: #008080;"> 3</span> dic={<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">alvin</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>:23,<span style="color: #800000;">'</span><span style="color: #800000;">sex</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">male</span><span style="color: #800000;">'</span><span style="color: #000000;">}
</span><span style="color: #008080;"> 4</span>  
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">print</span>(type(dic))<span style="color: #008000;">#</span><span style="color: #008000;">&lt;class 'dict'&gt;</span>
<span style="color: #008080;"> 6</span>  
<span style="color: #008080;"> 7</span> j=<span style="color: #000000;">pickle.dumps(dic)
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">print</span>(type(j))<span style="color: #008000;">#</span><span style="color: #008000;">&lt;class 'bytes'&gt;</span>
<span style="color: #008080;"> 9</span>  
<span style="color: #008080;">10</span>  
<span style="color: #008080;">11</span> f=open(<span style="color: #800000;">'</span><span style="color: #800000;">序列化对象_pickle</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">wb</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">注意是w是写入str,wb是写入bytes,j是'bytes'</span>
<span style="color: #008080;">12</span> f.write(j)  <span style="color: #008000;">#</span><span style="color: #008000;">-------------------等价于pickle.dump(dic,f)</span>
<span style="color: #008080;">13</span>  
<span style="color: #008080;">14</span> <span style="color: #000000;">f.close()
</span><span style="color: #008080;">15</span> <span style="color: #008000;">#</span><span style="color: #008000;">-------------------------反序列化</span>
<span style="color: #008080;">16</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> pickle
</span><span style="color: #008080;">17</span> f=open(<span style="color: #800000;">'</span><span style="color: #800000;">序列化对象_pickle</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">rb</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">18</span>  
<span style="color: #008080;">19</span> data=pickle.loads(f.read())<span style="color: #008000;">#</span><span style="color: #008000;">  等价于data=pickle.load(f)</span>
<span style="color: #008080;">20</span>  
<span style="color: #008080;">21</span>  
<span style="color: #008080;">22</span> <span style="color: #0000ff;">print</span>(data[<span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>])   </pre>
</div>
<p>&nbsp; &nbsp; Pickle的问题和所有其他编程语言特有的序列化问题一样，就是它只能用于Python，并且可能不同版本的Python彼此都不兼容，因此，只能用Pickle保存那些不重要的数据，不能成功地反序列化也没关系。</p>
<h1>七 shelve模块</h1>
<p>&nbsp;shelve模块比pickle模块简单，只有一个open函数，返回类似字典的对象，可读可写;key必须为字符串，而值可以是python所支持的数据类型</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> shelve

f</span>=shelve.open(r<span style="color: #800000;">'</span><span style="color: #800000;">sheve.txt</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> f['stu1_info']={'name':'egon','age':18,'hobby':['piao','smoking','drinking']}</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f['stu2_info']={'name':'gangdan','age':53}</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f['school_info']={'website':'http://www.pypy.org','city':'beijing'}</span>

<span style="color: #0000ff;">print</span>(f[<span style="color: #800000;">'</span><span style="color: #800000;">stu1_info</span><span style="color: #800000;">'</span>][<span style="color: #800000;">'</span><span style="color: #800000;">hobby</span><span style="color: #800000;">'</span><span style="color: #000000;">])
f.close()</span></pre>
</div>
<h1>八 xml模块</h1>
<p>xml是实现不同语言或程序之间进行数据交换的协议，跟json差不多，但json使用起来更简单，不过，古时候，在json还没诞生的黑暗年代，大家只能选择用xml呀，至今很多传统公司如金融行业的很多系统的接口还主要是xml。</p>
<p>xml的格式如下，就是通过&lt;&gt;节点来区别数据结构的:</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('8154c02b-3e5d-457c-93ee-740301584db0')"><img id="code_img_closed_8154c02b-3e5d-457c-93ee-740301584db0" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_8154c02b-3e5d-457c-93ee-740301584db0" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8154c02b-3e5d-457c-93ee-740301584db0',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_8154c02b-3e5d-457c-93ee-740301584db0" class="cnblogs_code_hide">
<pre>&lt;?xml version=<span style="color: #800000;">"</span><span style="color: #800000;">1.0</span><span style="color: #800000;">"</span>?&gt;
&lt;data&gt;
    &lt;country name=<span style="color: #800000;">"</span><span style="color: #800000;">Liechtenstein</span><span style="color: #800000;">"</span>&gt;
        &lt;rank updated=<span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span>&gt;2&lt;/rank&gt;
        &lt;year&gt;2008&lt;/year&gt;
        &lt;gdppc&gt;141100&lt;/gdppc&gt;
        &lt;neighbor name=<span style="color: #800000;">"</span><span style="color: #800000;">Austria</span><span style="color: #800000;">"</span> direction=<span style="color: #800000;">"</span><span style="color: #800000;">E</span><span style="color: #800000;">"</span>/&gt;
        &lt;neighbor name=<span style="color: #800000;">"</span><span style="color: #800000;">Switzerland</span><span style="color: #800000;">"</span> direction=<span style="color: #800000;">"</span><span style="color: #800000;">W</span><span style="color: #800000;">"</span>/&gt;
    &lt;/country&gt;
    &lt;country name=<span style="color: #800000;">"</span><span style="color: #800000;">Singapore</span><span style="color: #800000;">"</span>&gt;
        &lt;rank updated=<span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span>&gt;5&lt;/rank&gt;
        &lt;year&gt;2011&lt;/year&gt;
        &lt;gdppc&gt;59900&lt;/gdppc&gt;
        &lt;neighbor name=<span style="color: #800000;">"</span><span style="color: #800000;">Malaysia</span><span style="color: #800000;">"</span> direction=<span style="color: #800000;">"</span><span style="color: #800000;">N</span><span style="color: #800000;">"</span>/&gt;
    &lt;/country&gt;
    &lt;country name=<span style="color: #800000;">"</span><span style="color: #800000;">Panama</span><span style="color: #800000;">"</span>&gt;
        &lt;rank updated=<span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span>&gt;69&lt;/rank&gt;
        &lt;year&gt;2011&lt;/year&gt;
        &lt;gdppc&gt;13600&lt;/gdppc&gt;
        &lt;neighbor name=<span style="color: #800000;">"</span><span style="color: #800000;">Costa Rica</span><span style="color: #800000;">"</span> direction=<span style="color: #800000;">"</span><span style="color: #800000;">W</span><span style="color: #800000;">"</span>/&gt;
        &lt;neighbor name=<span style="color: #800000;">"</span><span style="color: #800000;">Colombia</span><span style="color: #800000;">"</span> direction=<span style="color: #800000;">"</span><span style="color: #800000;">E</span><span style="color: #800000;">"</span>/&gt;
    &lt;/country&gt;
&lt;/data&gt;</pre>
</div>
<span class="cnblogs_code_collapse">xml数据</span></div>
<p>xml协议在各个语言里的都 是支持的，在python中可以用以下模块操作xml：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;"> print(root.iter('year')) #全文搜索</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(root.find('country')) #在root的子节点找，只找一个</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(root.findall('country')) #在root的子节点找，找所有</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('66f408f0-9f9c-418f-87ad-a82ede86519f')"><img id="code_img_closed_66f408f0-9f9c-418f-87ad-a82ede86519f" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_66f408f0-9f9c-418f-87ad-a82ede86519f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('66f408f0-9f9c-418f-87ad-a82ede86519f',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_66f408f0-9f9c-418f-87ad-a82ede86519f" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> xml.etree.ElementTree as ET
 
tree </span>= ET.parse(<span style="color: #800000;">"</span><span style="color: #800000;">xmltest.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">)
root </span>=<span style="color: #000000;"> tree.getroot()
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(root.tag)
 
</span><span style="color: #008000;">#</span><span style="color: #008000;">遍历xml文档</span>
<span style="color: #0000ff;">for</span> child <span style="color: #0000ff;">in</span><span style="color: #000000;"> root:
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">========&gt;</span><span style="color: #800000;">'</span>,child.tag,child.attrib,child.attrib[<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span><span style="color: #000000;">])
    </span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> child:
        </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(i.tag,i.attrib,i.text)
 
</span><span style="color: #008000;">#</span><span style="color: #008000;">只遍历year 节点</span>
<span style="color: #0000ff;">for</span> node <span style="color: #0000ff;">in</span> root.iter(<span style="color: #800000;">'</span><span style="color: #800000;">year</span><span style="color: #800000;">'</span><span style="color: #000000;">):
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(node.tag,node.text)
</span><span style="color: #008000;">#</span><span style="color: #008000;">---------------------------------------</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> xml.etree.ElementTree as ET
 
tree </span>= ET.parse(<span style="color: #800000;">"</span><span style="color: #800000;">xmltest.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">)
root </span>=<span style="color: #000000;"> tree.getroot()
 
</span><span style="color: #008000;">#</span><span style="color: #008000;">修改</span>
<span style="color: #0000ff;">for</span> node <span style="color: #0000ff;">in</span> root.iter(<span style="color: #800000;">'</span><span style="color: #800000;">year</span><span style="color: #800000;">'</span><span style="color: #000000;">):
    new_year</span>=int(node.text)+1<span style="color: #000000;">
    node.text</span>=<span style="color: #000000;">str(new_year)
    node.set(</span><span style="color: #800000;">'</span><span style="color: #800000;">updated</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">yes</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    node.set(</span><span style="color: #800000;">'</span><span style="color: #800000;">version</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">1.0</span><span style="color: #800000;">'</span><span style="color: #000000;">)
tree.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">test.xml</span><span style="color: #800000;">'</span><span style="color: #000000;">)
 
 
</span><span style="color: #008000;">#</span><span style="color: #008000;">删除node</span>
<span style="color: #0000ff;">for</span> country <span style="color: #0000ff;">in</span> root.findall(<span style="color: #800000;">'</span><span style="color: #800000;">country</span><span style="color: #800000;">'</span><span style="color: #000000;">):
   rank </span>= int(country.find(<span style="color: #800000;">'</span><span style="color: #800000;">rank</span><span style="color: #800000;">'</span><span style="color: #000000;">).text)
   </span><span style="color: #0000ff;">if</span> rank &gt; 50<span style="color: #000000;">:
     root.remove(country)
 
tree.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">output.xml</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">在country内添加（append）节点year2</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> xml.etree.ElementTree as ET
tree </span>= ET.parse(<span style="color: #800000;">"</span><span style="color: #800000;">a.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">)
root</span>=<span style="color: #000000;">tree.getroot()
</span><span style="color: #0000ff;">for</span> country <span style="color: #0000ff;">in</span> root.findall(<span style="color: #800000;">'</span><span style="color: #800000;">country</span><span style="color: #800000;">'</span><span style="color: #000000;">):
    </span><span style="color: #0000ff;">for</span> year <span style="color: #0000ff;">in</span> country.findall(<span style="color: #800000;">'</span><span style="color: #800000;">year</span><span style="color: #800000;">'</span><span style="color: #000000;">):
        </span><span style="color: #0000ff;">if</span> int(year.text) &gt; 2000<span style="color: #000000;">:
            year2</span>=ET.Element(<span style="color: #800000;">'</span><span style="color: #800000;">year2</span><span style="color: #800000;">'</span><span style="color: #000000;">)
            year2.text</span>=<span style="color: #800000;">'</span><span style="color: #800000;">新年</span><span style="color: #800000;">'</span><span style="color: #000000;">
            year2.attrib</span>={<span style="color: #800000;">'</span><span style="color: #800000;">update</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">yes</span><span style="color: #800000;">'</span><span style="color: #000000;">}
            country.append(year2) </span><span style="color: #008000;">#</span><span style="color: #008000;">往country节点下添加子节点</span>
<span style="color: #000000;">
tree.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">a.xml.swap</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>自己创建xml文档：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4252fd07-212b-4fd8-a874-d58dd038f1bb')"><img id="code_img_closed_4252fd07-212b-4fd8-a874-d58dd038f1bb" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_4252fd07-212b-4fd8-a874-d58dd038f1bb" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('4252fd07-212b-4fd8-a874-d58dd038f1bb',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_4252fd07-212b-4fd8-a874-d58dd038f1bb" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> xml.etree.ElementTree as ET
 
 
new_xml </span>= ET.Element(<span style="color: #800000;">"</span><span style="color: #800000;">namelist</span><span style="color: #800000;">"</span><span style="color: #000000;">)
name </span>= ET.SubElement(new_xml,<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,attrib={<span style="color: #800000;">"</span><span style="color: #800000;">enrolled</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span><span style="color: #000000;">})
age </span>= ET.SubElement(name,<span style="color: #800000;">"</span><span style="color: #800000;">age</span><span style="color: #800000;">"</span>,attrib={<span style="color: #800000;">"</span><span style="color: #800000;">checked</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;">no</span><span style="color: #800000;">"</span><span style="color: #000000;">})
sex </span>= ET.SubElement(name,<span style="color: #800000;">"</span><span style="color: #800000;">sex</span><span style="color: #800000;">"</span><span style="color: #000000;">)
sex.text </span>= <span style="color: #800000;">'</span><span style="color: #800000;">33</span><span style="color: #800000;">'</span><span style="color: #000000;">
name2 </span>= ET.SubElement(new_xml,<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,attrib={<span style="color: #800000;">"</span><span style="color: #800000;">enrolled</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;">no</span><span style="color: #800000;">"</span><span style="color: #000000;">})
age </span>= ET.SubElement(name2,<span style="color: #800000;">"</span><span style="color: #800000;">age</span><span style="color: #800000;">"</span><span style="color: #000000;">)
age.text </span>= <span style="color: #800000;">'</span><span style="color: #800000;">19</span><span style="color: #800000;">'</span><span style="color: #000000;">
 
et </span>= ET.ElementTree(new_xml) <span style="color: #008000;">#</span><span style="color: #008000;">生成文档对象</span>
et.write(<span style="color: #800000;">"</span><span style="color: #800000;">test.xml</span><span style="color: #800000;">"</span>, encoding=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span>,xml_declaration=<span style="color: #000000;">True)
 
ET.dump(new_xml) </span><span style="color: #008000;">#</span><span style="color: #008000;">打印生成的格式</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h1>九 configparser模块</h1>
<p><strong>配置文件如下：</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;"> 注释1</span>
<span style="color: #000000;">; 注释2

[section1]
k1 </span>=<span style="color: #000000;"> v1
k2:v2
user</span>=<span style="color: #000000;">egon
age</span>=18<span style="color: #000000;">
is_admin</span>=<span style="color: #000000;">true
salary</span>=31<span style="color: #000000;">
<br />[section2]
k1 </span>= v1</pre>
</div>
<p><strong>读取</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> configparser

config</span>=<span style="color: #000000;">configparser.ConfigParser()
config.read(</span><span style="color: #800000;">'</span><span style="color: #800000;">a.cfg</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">查看所有的标题</span>
res=config.sections() <span style="color: #008000;">#</span><span style="color: #008000;">['section1', 'section2']</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(res)

</span><span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下所有key=value的key</span>
options=config.options(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(options) <span style="color: #008000;">#</span><span style="color: #008000;">['k1', 'k2', 'user', 'age', 'is_admin', 'salary']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下所有key=value的(key,value)格式</span>
item_list=config.items(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(item_list) <span style="color: #008000;">#</span><span style="color: #008000;">[('k1', 'v1'), ('k2', 'v2'), ('user', 'egon'), ('age', '18'), ('is_admin', 'true'), ('salary', '31')]</span>

<span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下user的值=&gt;字符串格式</span>
val=config.get(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">user</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(val) <span style="color: #008000;">#</span><span style="color: #008000;">egon</span>

<span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下age的值=&gt;整数格式</span>
val1=config.getint(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(val1) <span style="color: #008000;">#</span><span style="color: #008000;">18</span>

<span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下is_admin的值=&gt;布尔值格式</span>
val2=config.getboolean(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">is_admin</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(val2) <span style="color: #008000;">#</span><span style="color: #008000;">True</span>

<span style="color: #008000;">#</span><span style="color: #008000;">查看标题section1下salary的值=&gt;浮点型格式</span>
val3=config.getfloat(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">salary</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(val3) <span style="color: #008000;">#</span><span style="color: #008000;">31.0</span></pre>
</div>
<p><strong>改写</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> configparser

config</span>=<span style="color: #000000;">configparser.ConfigParser()
config.read(</span><span style="color: #800000;">'</span><span style="color: #800000;">a.cfg</span><span style="color: #800000;">',encoding='utf-8'</span><span style="color: #000000;">)


</span><span style="color: #008000;">#</span><span style="color: #008000;">删除整个标题section2</span>
config.remove_section(<span style="color: #800000;">'</span><span style="color: #800000;">section2</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">删除标题section1下的某个k1和k2</span>
config.remove_option(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">k1</span><span style="color: #800000;">'</span><span style="color: #000000;">)
config.remove_option(</span><span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">k2</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">判断是否存在某个标题</span>
<span style="color: #0000ff;">print</span>(config.has_section(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span><span style="color: #000000;">))

</span><span style="color: #008000;">#</span><span style="color: #008000;">判断标题section1下是否有user</span>
<span style="color: #0000ff;">print</span>(config.has_option(<span style="color: #800000;">'</span><span style="color: #800000;">section1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">''</span><span style="color: #000000;">))


</span><span style="color: #008000;">#</span><span style="color: #008000;">添加一个标题</span>
config.add_section(<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">在标题egon下添加name=egon,age=18的配置</span>
config.set(<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)
config.set(</span><span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>,18) <span style="color: #008000;">#</span><span style="color: #008000;">报错,必须是字符串</span>


<span style="color: #008000;">#</span><span style="color: #008000;">最后将修改的内容写入文件,完成最终的修改</span>
config.write(open(<span style="color: #800000;">'</span><span style="color: #800000;">a.cfg</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span>))</pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('bfce6110-696b-4e57-a515-b8093af96e9a')"><img id="code_img_closed_bfce6110-696b-4e57-a515-b8093af96e9a" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_bfce6110-696b-4e57-a515-b8093af96e9a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('bfce6110-696b-4e57-a515-b8093af96e9a',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_bfce6110-696b-4e57-a515-b8093af96e9a" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> configparser
  
config </span>=<span style="color: #000000;"> configparser.ConfigParser()
config[</span><span style="color: #800000;">"</span><span style="color: #800000;">DEFAULT</span><span style="color: #800000;">"</span>] = {<span style="color: #800000;">'</span><span style="color: #800000;">ServerAliveInterval</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">45</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                      </span><span style="color: #800000;">'</span><span style="color: #800000;">Compression</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">yes</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                     </span><span style="color: #800000;">'</span><span style="color: #800000;">CompressionLevel</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">}
  
config[</span><span style="color: #800000;">'</span><span style="color: #800000;">bitbucket.org</span><span style="color: #800000;">'</span>] =<span style="color: #000000;"> {}
config[</span><span style="color: #800000;">'</span><span style="color: #800000;">bitbucket.org</span><span style="color: #800000;">'</span>][<span style="color: #800000;">'</span><span style="color: #800000;">User</span><span style="color: #800000;">'</span>] = <span style="color: #800000;">'</span><span style="color: #800000;">hg</span><span style="color: #800000;">'</span><span style="color: #000000;">
config[</span><span style="color: #800000;">'</span><span style="color: #800000;">topsecret.server.com</span><span style="color: #800000;">'</span>] =<span style="color: #000000;"> {}
topsecret </span>= config[<span style="color: #800000;">'</span><span style="color: #800000;">topsecret.server.com</span><span style="color: #800000;">'</span><span style="color: #000000;">]
topsecret[</span><span style="color: #800000;">'</span><span style="color: #800000;">Host Port</span><span style="color: #800000;">'</span>] = <span style="color: #800000;">'</span><span style="color: #800000;">50022</span><span style="color: #800000;">'</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> mutates the parser</span>
topsecret[<span style="color: #800000;">'</span><span style="color: #800000;">ForwardX11</span><span style="color: #800000;">'</span>] = <span style="color: #800000;">'</span><span style="color: #800000;">no</span><span style="color: #800000;">'</span>  <span style="color: #008000;">#</span><span style="color: #008000;"> same here</span>
config[<span style="color: #800000;">'</span><span style="color: #800000;">DEFAULT</span><span style="color: #800000;">'</span>][<span style="color: #800000;">'</span><span style="color: #800000;">ForwardX11</span><span style="color: #800000;">'</span>] = <span style="color: #800000;">'</span><span style="color: #800000;">yes</span><span style="color: #800000;">'</span><span style="color: #000000;">
with open(</span><span style="color: #800000;">'</span><span style="color: #800000;">example.ini</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">) as configfile:
   config.write(configfile)</span></pre>
</div>
<span class="cnblogs_code_collapse">基于上述方法添加一个ini文档</span></div>
<h1>十 hashlib模块</h1>
<p>hash：一种算法 ,3.x里代替了md5模块和sha模块，主要提供&nbsp;SHA1, SHA224, SHA256, SHA384, SHA512 ，MD5 算法<br />三个特点：<br />1.内容相同则hash运算结果相同，内容稍微改变则hash值则变<br />2.不可逆推<br />3.相同算法：无论校验多长的数据，得到的哈希值长度固定。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> hashlib
</span><span style="color: #008080;"> 2</span>  
<span style="color: #008080;"> 3</span> m=hashlib.md5()<span style="color: #008000;">#</span><span style="color: #008000;"> m=hashlib.sha256()</span>
<span style="color: #008080;"> 4</span>  
<span style="color: #008080;"> 5</span> m.update(<span style="color: #800000;">'</span><span style="color: #800000;">hello</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">print</span>(m.hexdigest())  <span style="color: #008000;">#</span><span style="color: #008000;">5d41402abc4b2a76b9719d911017c592</span>
<span style="color: #008080;"> 7</span>  
<span style="color: #008080;"> 8</span> m.update(<span style="color: #800000;">'</span><span style="color: #800000;">alvin</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;"> 9</span>  
<span style="color: #008080;">10</span> <span style="color: #0000ff;">print</span>(m.hexdigest())  <span style="color: #008000;">#</span><span style="color: #008000;">92a7e713c30abbb0319fa07da2a5c4af</span>
<span style="color: #008080;">11</span>  
<span style="color: #008080;">12</span> m2=<span style="color: #000000;">hashlib.md5()
</span><span style="color: #008080;">13</span> m2.update(<span style="color: #800000;">'</span><span style="color: #800000;">helloalvin</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">14</span> <span style="color: #0000ff;">print</span>(m2.hexdigest()) <span style="color: #008000;">#</span><span style="color: #008000;">92a7e713c30abbb0319fa07da2a5c4af</span>
<span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span> <span style="color: #800000;">'''</span>
<span style="color: #008080;">17</span> <span style="color: #800000;">注意：把一段很长的数据update多次，与一次update这段长数据，得到的结果一样
</span><span style="color: #008080;">18</span> <span style="color: #800000;">但是update多次为校验大文件提供了可能。
</span><span style="color: #008080;">19</span> <span style="color: #800000;">'''</span></pre>
</div>
<p>&nbsp;</p>
<p>以上加密算法虽然依然非常厉害，但时候存在缺陷，即：通过撞库可以反解。所以，有必要对加密算法中添加自定义key再来做加密。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> hashlib
</span><span style="color: #008080;">2</span>  
<span style="color: #008080;">3</span> <span style="color: #008000;">#</span><span style="color: #008000;"> ######## 256 ########</span>
<span style="color: #008080;">4</span>  
<span style="color: #008080;">5</span> hash = hashlib.sha256(<span style="color: #800000;">'</span><span style="color: #800000;">898oaFs09f</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">6</span> hash.update(<span style="color: #800000;">'</span><span style="color: #800000;">alvin</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">7</span> <span style="color: #0000ff;">print</span> (hash.hexdigest())<span style="color: #008000;">#</span><span style="color: #008000;">e79e68f070cdedcfe63eaf1a2e92c83b4cfb1b5c6bc452d214c1b7e77cdfd1c7</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('5d932d53-c44a-41af-8b9b-19d08199341f')"><img id="code_img_closed_5d932d53-c44a-41af-8b9b-19d08199341f" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_5d932d53-c44a-41af-8b9b-19d08199341f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5d932d53-c44a-41af-8b9b-19d08199341f',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_5d932d53-c44a-41af-8b9b-19d08199341f" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> hashlib
passwds</span>=<span style="color: #000000;">[
    </span><span style="color: #800000;">'</span><span style="color: #800000;">alex3714</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">alex1313</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">alex94139413</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">alex123456</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">123456alex</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">a123lex</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    ]
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> make_passwd_dic(passwds):
    dic</span>=<span style="color: #000000;">{}
    </span><span style="color: #0000ff;">for</span> passwd <span style="color: #0000ff;">in</span><span style="color: #000000;"> passwds:
        m</span>=<span style="color: #000000;">hashlib.md5()
        m.update(passwd.encode(</span><span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
        dic[passwd]</span>=<span style="color: #000000;">m.hexdigest()
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> dic

</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> break_code(cryptograph,passwd_dic):
    </span><span style="color: #0000ff;">for</span> k,v <span style="color: #0000ff;">in</span><span style="color: #000000;"> passwd_dic.items():
        </span><span style="color: #0000ff;">if</span> v ==<span style="color: #000000;"> cryptograph:
            </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">密码是===&gt;\033[46m%s\033[0m</span><span style="color: #800000;">'</span> %<span style="color: #000000;">k)

cryptograph</span>=<span style="color: #800000;">'</span><span style="color: #800000;">aee949757a2e698417463d47acac93df</span><span style="color: #800000;">'</span><span style="color: #000000;">
break_code(cryptograph,make_passwd_dic(passwds))</span></pre>
</div>
<span class="cnblogs_code_collapse">模拟撞库破解密码</span></div>
<p>&nbsp;</p>
<p>python 还有一个 hmac 模块，它内部对我们创建 key 和 内容 进行进一步的处理然后再加密:</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> hmac
</span><span style="color: #008080;">2</span> h = hmac.new(<span style="color: #800000;">'</span><span style="color: #800000;">alvin</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span> h.update(<span style="color: #800000;">'</span><span style="color: #800000;">hello</span><span style="color: #800000;">'</span>.encode(<span style="color: #800000;">'</span><span style="color: #800000;">utf8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">4</span> <span style="color: #0000ff;">print</span> (h.hexdigest())<span style="color: #008000;">#</span><span style="color: #008000;">320df9832eab4c038b6c1d7ed73a5940</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('99ecfb07-94f2-4e25-83a9-ca9ecb3d8014')"><img id="code_img_closed_99ecfb07-94f2-4e25-83a9-ca9ecb3d8014" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_99ecfb07-94f2-4e25-83a9-ca9ecb3d8014" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('99ecfb07-94f2-4e25-83a9-ca9ecb3d8014',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_99ecfb07-94f2-4e25-83a9-ca9ecb3d8014" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">要想保证hmac最终结果一致，必须保证：</span><span style="color: #008000;">
#</span><span style="color: #008000;">1:hmac.new括号内指定的初始key一样</span><span style="color: #008000;">
#</span><span style="color: #008000;">2:无论update多少次，校验的内容累加到一起是一样的内容</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> hmac

h1</span>=hmac.new(b<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)
h1.update(b</span><span style="color: #800000;">'</span><span style="color: #800000;">hello</span><span style="color: #800000;">'</span><span style="color: #000000;">)
h1.update(b</span><span style="color: #800000;">'</span><span style="color: #800000;">world</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(h1.hexdigest())

h2</span>=hmac.new(b<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)
h2.update(b</span><span style="color: #800000;">'</span><span style="color: #800000;">helloworld</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(h2.hexdigest())

h3</span>=hmac.new(b<span style="color: #800000;">'</span><span style="color: #800000;">egonhelloworld</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(h3.hexdigest())

</span><span style="color: #800000;">'''</span><span style="color: #800000;">
f1bf38d054691688f89dcd34ac3c27f2
f1bf38d054691688f89dcd34ac3c27f2
bcca84edd9eeb86f30539922b28f3981
</span><span style="color: #800000;">'''</span></pre>
</div>
<span class="cnblogs_code_collapse">注意！注意！注意</span></div>
<p>&nbsp;</p>
<h1>十一 suprocess模块</h1>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;">  subprocess
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #800000;">'''</span>
<span style="color: #008080;"> 4</span> <span style="color: #800000;">sh-3.2# ls /Users/egon/Desktop |grep txt$
</span><span style="color: #008080;"> 5</span> <span style="color: #800000;">mysql.txt
</span><span style="color: #008080;"> 6</span> <span style="color: #800000;">tt.txt
</span><span style="color: #008080;"> 7</span> <span style="color: #800000;">事物.txt
</span><span style="color: #008080;"> 8</span> <span style="color: #800000;">'''</span>
<span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> res1=subprocess.Popen(<span style="color: #800000;">'</span><span style="color: #800000;">ls /Users/jieli/Desktop</span><span style="color: #800000;">'</span>,shell=True,stdout=<span style="color: #000000;">subprocess.PIPE)
</span><span style="color: #008080;">11</span> res=subprocess.Popen(<span style="color: #800000;">'</span><span style="color: #800000;">grep txt$</span><span style="color: #800000;">'</span>,shell=True,stdin=<span style="color: #000000;">res1.stdout,
</span><span style="color: #008080;">12</span>                  stdout=<span style="color: #000000;">subprocess.PIPE)
</span><span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span> <span style="color: #0000ff;">print</span>(res.stdout.read().decode(<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span> <span style="color: #008000;">#</span><span style="color: #008000;">等同于上面,但是上面的优势在于,一个数据流可以和另外一个数据流交互,可以通过爬虫得到结果然后交给grep</span>
<span style="color: #008080;">18</span> res1=subprocess.Popen(<span style="color: #800000;">'</span><span style="color: #800000;">ls /Users/jieli/Desktop |grep txt$</span><span style="color: #800000;">'</span>,shell=True,stdout=<span style="color: #000000;">subprocess.PIPE)
</span><span style="color: #008080;">19</span> <span style="color: #0000ff;">print</span>(res1.stdout.read().decode(<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span> <span style="color: #008000;">#</span><span style="color: #008000;">windows下:</span>
<span style="color: #008080;">23</span> <span style="color: #008000;">#</span><span style="color: #008000;"> dir | findstr 'test*'</span>
<span style="color: #008080;">24</span> <span style="color: #008000;">#</span><span style="color: #008000;"> dir | findstr 'txt$'</span>
<span style="color: #008080;">25</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> subprocess
</span><span style="color: #008080;">26</span> res1=subprocess.Popen(r<span style="color: #800000;">'</span><span style="color: #800000;">dir C:\Users\Administrator\PycharmProjects\test\函数备课</span><span style="color: #800000;">'</span>,shell=True,stdout=<span style="color: #000000;">subprocess.PIPE)
</span><span style="color: #008080;">27</span> res=subprocess.Popen(<span style="color: #800000;">'</span><span style="color: #800000;">findstr test*</span><span style="color: #800000;">'</span>,shell=True,stdin=<span style="color: #000000;">res1.stdout,
</span><span style="color: #008080;">28</span>                  stdout=<span style="color: #000000;">subprocess.PIPE)
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span> <span style="color: #0000ff;">print</span>(res.stdout.read().decode(<span style="color: #800000;">'</span><span style="color: #800000;">gbk</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">subprocess使用当前系统默认编码，得到结果为bytes类型，在windows下需要用gbk解码</span></pre>
</div>
<p><span style="font-size: 14pt;"><a href="https://docs.python.org/2/library/subprocess.html?highlight=subprocess#frequently-used-arguments" target="_blank">&nbsp;详细参考官网</a></span></p>
<h1>十二 logging模块</h1>
<p><span style="font-size: 14pt; color: #000000;"><strong>一 日志级别</strong></span></p>
<div class="cnblogs_code">
<pre>CRITICAL = 50 <span style="color: #008000;">#</span><span style="color: #008000;">FATAL = CRITICAL</span>
ERROR = 40<span style="color: #000000;">
WARNING </span>= 30 <span style="color: #008000;">#</span><span style="color: #008000;">WARN = WARNING</span>
INFO = 20<span style="color: #000000;">
DEBUG </span>= 10<span style="color: #000000;">
NOTSET </span>= 0 <span style="color: #008000;">#</span><span style="color: #008000;">不设置</span></pre>
</div>
<p><strong><span style="font-size: 14pt;">二 默认级别为warning，默认打印到终端</span></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> logging

logging.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">调试debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.info(</span><span style="color: #800000;">'</span><span style="color: #800000;">消息info</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.warning(</span><span style="color: #800000;">'</span><span style="color: #800000;">警告warn</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.error(</span><span style="color: #800000;">'</span><span style="color: #800000;">错误error</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.critical(</span><span style="color: #800000;">'</span><span style="color: #800000;">严重critical</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #800000;">'''</span><span style="color: #800000;">
WARNING:root:警告warn
ERROR:root:错误error
CRITICAL:root:严重critical
</span><span style="color: #800000;">'''</span></pre>
</div>
<p><span style="font-size: 14pt;"><strong>三 为logging模块指定全局配置，针对所有logger有效，控制打印到文件中</strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2b6c99ff-728d-446e-827f-1d044fe06afd')"><img id="code_img_closed_2b6c99ff-728d-446e-827f-1d044fe06afd" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_2b6c99ff-728d-446e-827f-1d044fe06afd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2b6c99ff-728d-446e-827f-1d044fe06afd',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_2b6c99ff-728d-446e-827f-1d044fe06afd" class="cnblogs_code_hide">
<pre><span style="color: #000000;">可在logging.basicConfig()函数中通过具体参数来更改logging模块默认行为，可用参数有
filename：用指定的文件名创建FiledHandler（后边会具体讲解handler的概念），这样日志会被存储在指定的文件中。
filemode：文件打开方式，在指定了filename时使用这个参数，默认值为&ldquo;a&rdquo;还可指定为&ldquo;w&rdquo;。
format：指定handler使用的日志显示格式。 
datefmt：指定日期时间格式。 
level：设置rootlogger（后边会讲解具体概念）的日志级别 
stream：用指定的stream创建StreamHandler。可以指定输出到sys.stderr,sys.stdout或者文件，默认为sys.stderr。若同时列出了filename和stream两个参数，则stream参数会被忽略。



</span><span style="color: #008000;">#</span><span style="color: #008000;">格式</span>
%<span style="color: #000000;">(name)s：Logger的名字，并非用户名，详细查看

</span>%<span style="color: #000000;">(levelno)s：数字形式的日志级别

</span>%<span style="color: #000000;">(levelname)s：文本形式的日志级别

</span>%<span style="color: #000000;">(pathname)s：调用日志输出函数的模块的完整路径名，可能没有

</span>%<span style="color: #000000;">(filename)s：调用日志输出函数的模块的文件名

</span>%<span style="color: #000000;">(module)s：调用日志输出函数的模块名

</span>%<span style="color: #000000;">(funcName)s：调用日志输出函数的函数名

</span>%<span style="color: #000000;">(lineno)d：调用日志输出函数的语句所在的代码行

</span>%<span style="color: #000000;">(created)f：当前时间，用UNIX标准的表示时间的浮 点数表示

</span>%<span style="color: #000000;">(relativeCreated)d：输出日志信息时的，自Logger创建以 来的毫秒数

</span>%(asctime)s：字符串形式的当前时间。默认格式是 &ldquo;2003-07-08 16:49:45,896<span style="color: #000000;">&rdquo;。逗号后面的是毫秒

</span>%<span style="color: #000000;">(thread)d：线程ID。可能没有

</span>%<span style="color: #000000;">(threadName)s：线程名。可能没有

</span>%<span style="color: #000000;">(process)d：进程ID。可能没有

</span>%<span style="color: #000000;">(message)s：用户输出的消息

 </span></pre>
</div>
<span class="cnblogs_code_collapse">logging.basicConfig()</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('45520d5c-6f67-4df9-a694-2909141bbf7a')"><img id="code_img_closed_45520d5c-6f67-4df9-a694-2909141bbf7a" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_45520d5c-6f67-4df9-a694-2909141bbf7a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('45520d5c-6f67-4df9-a694-2909141bbf7a',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_45520d5c-6f67-4df9-a694-2909141bbf7a" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">======介绍</span>
<span style="color: #000000;">可在logging.basicConfig()函数中可通过具体参数来更改logging模块默认行为，可用参数有
filename：用指定的文件名创建FiledHandler（后边会具体讲解handler的概念），这样日志会被存储在指定的文件中。
filemode：文件打开方式，在指定了filename时使用这个参数，默认值为&ldquo;a&rdquo;还可指定为&ldquo;w&rdquo;。
format：指定handler使用的日志显示格式。
datefmt：指定日期时间格式。
level：设置rootlogger（后边会讲解具体概念）的日志级别
stream：用指定的stream创建StreamHandler。可以指定输出到sys.stderr,sys.stdout或者文件，默认为sys.stderr。若同时列出了filename和stream两个参数，则stream参数会被忽略。


format参数中可能用到的格式化串：
</span>%<span style="color: #000000;">(name)s Logger的名字
</span>%<span style="color: #000000;">(levelno)s 数字形式的日志级别
</span>%<span style="color: #000000;">(levelname)s 文本形式的日志级别
</span>%<span style="color: #000000;">(pathname)s 调用日志输出函数的模块的完整路径名，可能没有
</span>%<span style="color: #000000;">(filename)s 调用日志输出函数的模块的文件名
</span>%<span style="color: #000000;">(module)s 调用日志输出函数的模块名
</span>%<span style="color: #000000;">(funcName)s 调用日志输出函数的函数名
</span>%<span style="color: #000000;">(lineno)d 调用日志输出函数的语句所在的代码行
</span>%<span style="color: #000000;">(created)f 当前时间，用UNIX标准的表示时间的浮 点数表示
</span>%<span style="color: #000000;">(relativeCreated)d 输出日志信息时的，自Logger创建以 来的毫秒数
</span>%(asctime)s 字符串形式的当前时间。默认格式是 &ldquo;2003-07-08 16:49:45,896<span style="color: #000000;">&rdquo;。逗号后面的是毫秒
</span>%<span style="color: #000000;">(thread)d 线程ID。可能没有
</span>%<span style="color: #000000;">(threadName)s 线程名。可能没有
</span>%<span style="color: #000000;">(process)d 进程ID。可能没有
</span>%<span style="color: #000000;">(message)s用户输出的消息




</span><span style="color: #008000;">#</span><span style="color: #008000;">========使用</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> logging
logging.basicConfig(filename</span>=<span style="color: #800000;">'</span><span style="color: #800000;">access.log</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    format</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    datefmt</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S %p</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    level</span>=10<span style="color: #000000;">)

logging.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">调试debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.info(</span><span style="color: #800000;">'</span><span style="color: #800000;">消息info</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.warning(</span><span style="color: #800000;">'</span><span style="color: #800000;">警告warn</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.error(</span><span style="color: #800000;">'</span><span style="color: #800000;">错误error</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logging.critical(</span><span style="color: #800000;">'</span><span style="color: #800000;">严重critical</span><span style="color: #800000;">'</span><span style="color: #000000;">)





</span><span style="color: #008000;">#</span><span style="color: #008000;">========结果</span>
<span style="color: #000000;">access.log内容:
</span>2017-07-28 20:32:17 PM - root - DEBUG -<span style="color: #000000;">test:  调试debug
</span>2017-07-28 20:32:17 PM - root - INFO -<span style="color: #000000;">test:  消息info
</span>2017-07-28 20:32:17 PM - root - WARNING -<span style="color: #000000;">test:  警告warn
</span>2017-07-28 20:32:17 PM - root - ERROR -<span style="color: #000000;">test:  错误error
</span>2017-07-28 20:32:17 PM - root - CRITICAL -<span style="color: #000000;">test:  严重critical

part2: 可以为logging模块指定模块级的配置,即所有logger的配置</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><span style="font-size: 14pt;"><strong>四 logging模块的Formatter，Handler，Logger，Filter对象</strong></span></p>
<p><a href="https://pan.baidu.com/s/1skWyTT7" target="_blank"><strong><span style="color: #ff0000;">原理图：https://pan.baidu.com/s/1skWyTT7</span></strong></a></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">logger：产生日志的对象</span>

<span style="color: #008000;">#</span><span style="color: #008000;">Filter：过滤日志的对象</span>

<span style="color: #008000;">#</span><span style="color: #008000;">Handler：接收日志然后控制打印到不同的地方，FileHandler用来打印到文件中，StreamHandler用来打印到终端</span>

<span style="color: #008000;">#</span><span style="color: #008000;">Formatter对象：可以定制不同的日志格式对象，然后绑定给不同的Handler对象使用，以此来控制不同的Handler的日志格式</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('8b57c565-880a-43f1-b81b-15e9cc2e065b')"><img id="code_img_closed_8b57c565-880a-43f1-b81b-15e9cc2e065b" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_8b57c565-880a-43f1-b81b-15e9cc2e065b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8b57c565-880a-43f1-b81b-15e9cc2e065b',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_8b57c565-880a-43f1-b81b-15e9cc2e065b" class="cnblogs_code_hide">
<pre><span style="color: #800000;">'''</span><span style="color: #800000;">
critical=50
error =40
warning =30
info = 20
debug =10
</span><span style="color: #800000;">'''</span>


<span style="color: #0000ff;">import</span><span style="color: #000000;"> logging

</span><span style="color: #008000;">#</span><span style="color: #008000;">1、logger对象：负责产生日志，然后交给Filter过滤，然后交给不同的Handler输出</span>
logger=logging.getLogger(<span style="color: #800080;">__file__</span><span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">2、Filter对象：不常用，略</span>

<span style="color: #008000;">#</span><span style="color: #008000;">3、Handler对象：接收logger传来的日志，然后控制输出</span>
h1=logging.FileHandler(<span style="color: #800000;">'</span><span style="color: #800000;">t1.log</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">打印到文件</span>
h2=logging.FileHandler(<span style="color: #800000;">'</span><span style="color: #800000;">t2.log</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">打印到文件</span>
h3=logging.StreamHandler() <span style="color: #008000;">#</span><span style="color: #008000;">打印到终端</span>

<span style="color: #008000;">#</span><span style="color: #008000;">4、Formatter对象：日志格式</span>
formmater1=logging.Formatter(<span style="color: #800000;">'</span><span style="color: #800000;">%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    datefmt</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S %p</span><span style="color: #800000;">'</span><span style="color: #000000;">,)

formmater2</span>=logging.Formatter(<span style="color: #800000;">'</span><span style="color: #800000;">%(asctime)s :  %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    datefmt</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S %p</span><span style="color: #800000;">'</span><span style="color: #000000;">,)

formmater3</span>=logging.Formatter(<span style="color: #800000;">'</span><span style="color: #800000;">%(name)s %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,)


</span><span style="color: #008000;">#</span><span style="color: #008000;">5、为Handler对象绑定格式</span>
<span style="color: #000000;">h1.setFormatter(formmater1)
h2.setFormatter(formmater2)
h3.setFormatter(formmater3)

</span><span style="color: #008000;">#</span><span style="color: #008000;">6、将Handler添加给logger并设置日志级别</span>
<span style="color: #000000;">logger.addHandler(h1)
logger.addHandler(h2)
logger.addHandler(h3)
logger.setLevel(</span>10<span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;">7、测试</span>
logger.debug(<span style="color: #800000;">'</span><span style="color: #800000;">debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger.info(</span><span style="color: #800000;">'</span><span style="color: #800000;">info</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger.warning(</span><span style="color: #800000;">'</span><span style="color: #800000;">warning</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger.error(</span><span style="color: #800000;">'</span><span style="color: #800000;">error</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger.critical(</span><span style="color: #800000;">'</span><span style="color: #800000;">critical</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><strong><span style="font-size: 14pt;">五 Logger与Handler的级别</span></strong></p>
<p><span style="color: #ff0000;"><strong>logger是第一级过滤，然后才能到handler，我们可以给logger和handler同时设置level，但是需要注意的是</strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('6ea771c9-6d73-4729-9fab-8afabd986d29')"><img id="code_img_closed_6ea771c9-6d73-4729-9fab-8afabd986d29" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_6ea771c9-6d73-4729-9fab-8afabd986d29" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('6ea771c9-6d73-4729-9fab-8afabd986d29',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_6ea771c9-6d73-4729-9fab-8afabd986d29" class="cnblogs_code_hide">
<pre>Logger <span style="color: #0000ff;">is</span> also the first to filter the message based on a level &mdash; <span style="color: #0000ff;">if</span> you set the logger to INFO, <span style="color: #0000ff;">and</span> all handlers to DEBUG, you still won<span style="color: #800000;">'</span><span style="color: #800000;">t receive DEBUG messages on handlers &mdash; they</span><span style="color: #800000;">'</span>ll be rejected by the logger itself. If you set logger to DEBUG, but all handlers to INFO, you won<span style="color: #800000;">'</span><span style="color: #800000;">t receive any DEBUG messages either &mdash; because while the logger says "ok, process this", the handlers reject it (DEBUG &lt; INFO).</span>



<span style="color: #008000;">#</span><span style="color: #008000;">验证</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> logging


form</span>=logging.Formatter(<span style="color: #800000;">'</span><span style="color: #800000;">%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    datefmt</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S %p</span><span style="color: #800000;">'</span><span style="color: #000000;">,)

ch</span>=<span style="color: #000000;">logging.StreamHandler()

ch.setFormatter(form)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> ch.setLevel(10)</span>
ch.setLevel(20<span style="color: #000000;">)

l1</span>=logging.getLogger(<span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> l1.setLevel(20)</span>
l1.setLevel(10<span style="color: #000000;">)
l1.addHandler(ch)

l1.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">l1 debug</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">重要，重要，重要！！！</span></div>
<p><strong><span style="font-size: 14pt;">六 Logger的继承（了解）</span></strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b384c0f4-ce29-4934-bc0d-48c66a10fa35')"><img id="code_img_closed_b384c0f4-ce29-4934-bc0d-48c66a10fa35" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_b384c0f4-ce29-4934-bc0d-48c66a10fa35" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b384c0f4-ce29-4934-bc0d-48c66a10fa35',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_b384c0f4-ce29-4934-bc0d-48c66a10fa35" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> logging

formatter</span>=logging.Formatter(<span style="color: #800000;">'</span><span style="color: #800000;">%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                    datefmt</span>=<span style="color: #800000;">'</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S %p</span><span style="color: #800000;">'</span><span style="color: #000000;">,)

ch</span>=<span style="color: #000000;">logging.StreamHandler()
ch.setFormatter(formatter)


logger1</span>=logging.getLogger(<span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger2</span>=logging.getLogger(<span style="color: #800000;">'</span><span style="color: #800000;">root.child1</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger3</span>=logging.getLogger(<span style="color: #800000;">'</span><span style="color: #800000;">root.child1.child2</span><span style="color: #800000;">'</span><span style="color: #000000;">)


logger1.addHandler(ch)
logger2.addHandler(ch)
logger3.addHandler(ch)
logger1.setLevel(</span>10<span style="color: #000000;">)
logger2.setLevel(</span>10<span style="color: #000000;">)
logger3.setLevel(</span>10<span style="color: #000000;">)

logger1.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">log1 debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger2.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">log2 debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
logger3.debug(</span><span style="color: #800000;">'</span><span style="color: #800000;">log3 debug</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #800000;">'''</span><span style="color: #800000;">
2017-07-28 22:22:05 PM - root - DEBUG -test:  log1 debug
2017-07-28 22:22:05 PM - root.child1 - DEBUG -test:  log2 debug
2017-07-28 22:22:05 PM - root.child1 - DEBUG -test:  log2 debug
2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug
2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug
2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug
</span><span style="color: #800000;">'''</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><strong><span style="font-size: 14pt;">七 应用</span></strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('a694a55c-ea43-480a-900a-65e4a31ec322')"><img id="code_img_closed_a694a55c-ea43-480a-900a-65e4a31ec322" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_a694a55c-ea43-480a-900a-65e4a31ec322" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a694a55c-ea43-480a-900a-65e4a31ec322',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_a694a55c-ea43-480a-900a-65e4a31ec322" class="cnblogs_code_hide">
<pre><span style="color: #800000;">"""</span><span style="color: #800000;">
logging配置
</span><span style="color: #800000;">"""</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> os
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> logging.config

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 定义三种日志输出格式 开始</span>
<span style="color: #000000;">
standard_format </span>= <span style="color: #800000;">'</span><span style="color: #800000;">[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]</span><span style="color: #800000;">'</span><span style="color: #000000;"> \
                  </span><span style="color: #800000;">'</span><span style="color: #800000;">[%(levelname)s][%(message)s]</span><span style="color: #800000;">'</span> <span style="color: #008000;">#</span><span style="color: #008000;">其中name为getlogger指定的名字</span>
<span style="color: #000000;">
simple_format </span>= <span style="color: #800000;">'</span><span style="color: #800000;">[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">

id_simple_format </span>= <span style="color: #800000;">'</span><span style="color: #800000;">[%(levelname)s][%(asctime)s] %(message)s</span><span style="color: #800000;">'</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 定义日志输出格式 结束</span>
<span style="color: #000000;">
logfile_dir </span>= os.path.dirname(os.path.abspath(<span style="color: #800080;">__file__</span>))  <span style="color: #008000;">#</span><span style="color: #008000;"> log文件的目录</span>
<span style="color: #000000;">
logfile_name </span>= <span style="color: #800000;">'</span><span style="color: #800000;">all2.log</span><span style="color: #800000;">'</span>  <span style="color: #008000;">#</span><span style="color: #008000;"> log文件名</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 如果不存在定义的日志目录就创建一个</span>
<span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span><span style="color: #000000;"> os.path.isdir(logfile_dir):
    os.mkdir(logfile_dir)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> log文件的全路径</span>
logfile_path =<span style="color: #000000;"> os.path.join(logfile_dir, logfile_name)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> log配置字典</span>
LOGGING_DIC =<span style="color: #000000;"> {
    </span><span style="color: #800000;">'</span><span style="color: #800000;">version</span><span style="color: #800000;">'</span>: 1<span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">disable_existing_loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: False,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">formatters</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #800000;">'</span><span style="color: #800000;">standard</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">format</span><span style="color: #800000;">'</span><span style="color: #000000;">: standard_format
        },
        </span><span style="color: #800000;">'</span><span style="color: #800000;">simple</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">format</span><span style="color: #800000;">'</span><span style="color: #000000;">: simple_format
        },
    },
    </span><span style="color: #800000;">'</span><span style="color: #800000;">filters</span><span style="color: #800000;">'</span><span style="color: #000000;">: {},
    </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到终端的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.StreamHandler</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 打印到屏幕</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">simple</span><span style="color: #800000;">'</span><span style="color: #000000;">
        },
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到文件的日志,收集info及以上的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.handlers.RotatingFileHandler</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 保存到文件</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">standard</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">filename</span><span style="color: #800000;">'</span>: logfile_path,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志文件</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">maxBytes</span><span style="color: #800000;">'</span>: 1024*1024*5,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志大小 5M</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">backupCount</span><span style="color: #800000;">'</span>: 5<span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">encoding</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志文件的编码，再也不用担心中文log乱码了</span>
<span style="color: #000000;">        },
    },
    </span><span style="color: #800000;">'</span><span style="color: #800000;">loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #008000;">#</span><span style="color: #008000;">logging.getLogger(__name__)拿到的logger配置</span>
        <span style="color: #800000;">''</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span>],  <span style="color: #008000;">#</span><span style="color: #008000;"> 这里把上面定义的两个handler都加上，即log数据既写入文件又打印到屏幕</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span>: True,  <span style="color: #008000;">#</span><span style="color: #008000;"> 向上（更高level的logger）传递</span>
<span style="color: #000000;">        },
    },
}


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> load_my_logging_cfg():
    logging.config.dictConfig(LOGGING_DIC)  </span><span style="color: #008000;">#</span><span style="color: #008000;"> 导入上面定义的logging配置</span>
    logger = logging.getLogger(<span style="color: #800080;">__name__</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 生成一个log实例</span>
    logger.info(<span style="color: #800000;">'</span><span style="color: #800000;">It works!</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 记录该文件的运行状态</span>

<span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    load_my_logging_cfg()</span></pre>
</div>
<span class="cnblogs_code_collapse">logging配置文件</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('a1252dd3-1c0f-4516-a427-b581e4cf9495')"><img id="code_img_closed_a1252dd3-1c0f-4516-a427-b581e4cf9495" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_a1252dd3-1c0f-4516-a427-b581e4cf9495" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a1252dd3-1c0f-4516-a427-b581e4cf9495',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_a1252dd3-1c0f-4516-a427-b581e4cf9495" class="cnblogs_code_hide">
<pre><span style="color: #800000;">"""</span><span style="color: #800000;">
MyLogging Test
</span><span style="color: #800000;">"""</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> time
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> logging
</span><span style="color: #0000ff;">import</span> my_logging  <span style="color: #008000;">#</span><span style="color: #008000;"> 导入自定义的logging配置</span>
<span style="color: #000000;">
logger </span>= logging.getLogger(<span style="color: #800080;">__name__</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 生成logger实例</span>


<span style="color: #0000ff;">def</span><span style="color: #000000;"> demo():
    logger.debug(</span><span style="color: #800000;">"</span><span style="color: #800000;">start range... time:{}</span><span style="color: #800000;">"</span><span style="color: #000000;">.format(time.time()))
    logger.info(</span><span style="color: #800000;">"</span><span style="color: #800000;">中文测试开始。。。</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> range(10<span style="color: #000000;">):
        logger.debug(</span><span style="color: #800000;">"</span><span style="color: #800000;">i:{}</span><span style="color: #800000;">"</span><span style="color: #000000;">.format(i))
        time.sleep(</span>0.2<span style="color: #000000;">)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        logger.debug(</span><span style="color: #800000;">"</span><span style="color: #800000;">over range... time:{}</span><span style="color: #800000;">"</span><span style="color: #000000;">.format(time.time()))
    logger.info(</span><span style="color: #800000;">"</span><span style="color: #800000;">中文测试结束。。。</span><span style="color: #800000;">"</span><span style="color: #000000;">)

</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">"</span><span style="color: #800000;">__main__</span><span style="color: #800000;">"</span><span style="color: #000000;">:
    my_logging.load_my_logging_cfg()  </span><span style="color: #008000;">#</span><span style="color: #008000;"> 在你程序文件的入口加载自定义logging配置</span>
    demo()</pre>
</div>
<span class="cnblogs_code_collapse">使用</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('a7ab945e-c2ca-4241-a822-75e0645670fa')"><img id="code_img_closed_a7ab945e-c2ca-4241-a822-75e0645670fa" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_a7ab945e-c2ca-4241-a822-75e0645670fa" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a7ab945e-c2ca-4241-a822-75e0645670fa',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_a7ab945e-c2ca-4241-a822-75e0645670fa" class="cnblogs_code_hide">
<pre><span style="color: #000000;">注意注意注意：


</span><span style="color: #008000;">#</span><span style="color: #008000;">1、有了上述方式我们的好处是：所有与logging模块有关的配置都写到字典中就可以了，更加清晰，方便管理</span>


<span style="color: #008000;">#</span><span style="color: #008000;">2、我们需要解决的问题是：</span>
    1<span style="color: #000000;">、从字典加载配置：logging.config.dictConfig(settings.LOGGING_DIC)

    </span>2<span style="color: #000000;">、拿到logger对象来产生日志
    logger对象都是配置到字典的loggers 键对应的子字典中的
    按照我们对logging模块的理解，要想获取某个东西都是通过名字，也就是key来获取的
    于是我们要获取不同的logger对象就是
    logger</span>=logging.getLogger(<span style="color: #800000;">'</span><span style="color: #800000;">loggers子字典的key名</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    
    但问题是：如果我们想要不同logger名的logger对象都共用一段配置，那么肯定不能在loggers子字典中定义n个key   
 </span><span style="color: #800000;">'</span><span style="color: #800000;">loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {    
        </span><span style="color: #800000;">'</span><span style="color: #800000;">l1</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span>],  <span style="color: #008000;">#
</span>            <span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span>: True,  <span style="color: #008000;">#</span><span style="color: #008000;"> 向上（更高level的logger）传递</span>
<span style="color: #000000;">        },
        </span><span style="color: #800000;">'</span><span style="color: #800000;">l2: {</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span><span style="color: #000000;"> ], 
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span>: False,  <span style="color: #008000;">#</span><span style="color: #008000;"> 向上（更高level的logger）传递</span>
<span style="color: #000000;">        },
        </span><span style="color: #800000;">'</span><span style="color: #800000;">l3</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span>],  <span style="color: #008000;">#
</span>            <span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span>: True,  <span style="color: #008000;">#</span><span style="color: #008000;"> 向上（更高level的logger）传递</span>
<span style="color: #000000;">        },

}

    
</span><span style="color: #008000;">#</span><span style="color: #008000;">我们的解决方式是，定义一个空的key</span>
    <span style="color: #800000;">'</span><span style="color: #800000;">loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #800000;">''</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span><span style="color: #000000;">], 
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span><span style="color: #000000;">: True, 
        },

}

这样我们再取logger对象时
logging.getLogger(</span><span style="color: #800080;">__name__</span>)，不同的文件__name__不同，这保证了打印日志时标识信息不同，但是拿着该名字去loggers里找key名时却发现找不到，于是默认使用key=<span style="color: #800000;">''</span>的配置</pre>
</div>
<span class="cnblogs_code_collapse">!!!关于如何拿到logger对象的详细解释！！！</span></div>
<pre>另外一个django的配置，瞄一眼就可以，跟上面的一样</pre>
<div class="cnblogs_code" onclick="cnblogs_code_show('154459db-a4e6-4858-b955-da761f6f84a8')"><img id="code_img_closed_154459db-a4e6-4858-b955-da761f6f84a8" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_154459db-a4e6-4858-b955-da761f6f84a8" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('154459db-a4e6-4858-b955-da761f6f84a8',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_154459db-a4e6-4858-b955-da761f6f84a8" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">logging_config.py</span>
LOGGING =<span style="color: #000000;"> {
    </span><span style="color: #800000;">'</span><span style="color: #800000;">version</span><span style="color: #800000;">'</span>: 1<span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">disable_existing_loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: False,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">formatters</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #800000;">'</span><span style="color: #800000;">standard</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">format</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]</span><span style="color: #800000;">'</span>
                      <span style="color: #800000;">'</span><span style="color: #800000;">[%(levelname)s][%(message)s]</span><span style="color: #800000;">'</span><span style="color: #000000;">
        },
        </span><span style="color: #800000;">'</span><span style="color: #800000;">simple</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">format</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">
        },
        </span><span style="color: #800000;">'</span><span style="color: #800000;">collect</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">format</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">%(message)s</span><span style="color: #800000;">'</span><span style="color: #000000;">
        }
    },
    </span><span style="color: #800000;">'</span><span style="color: #800000;">filters</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #800000;">'</span><span style="color: #800000;">require_debug_true</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">()</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">django.utils.log.RequireDebugTrue</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        },
    },
    </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到终端的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">filters</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">require_debug_true</span><span style="color: #800000;">'</span><span style="color: #000000;">],
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.StreamHandler</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">simple</span><span style="color: #800000;">'</span><span style="color: #000000;">
        },
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到文件的日志,收集info及以上的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">INFO</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.handlers.RotatingFileHandler</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 保存到文件，自动切</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">filename</span><span style="color: #800000;">'</span>: os.path.join(BASE_LOG_DIR, <span style="color: #800000;">"</span><span style="color: #800000;">xxx_info.log</span><span style="color: #800000;">"</span>),  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志文件</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">maxBytes</span><span style="color: #800000;">'</span>: 1024 * 1024 * 5,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志大小 5M</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">backupCount</span><span style="color: #800000;">'</span>: 3<span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">standard</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">encoding</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        },
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到文件的日志:收集错误及以上的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">error</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">ERROR</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.handlers.RotatingFileHandler</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 保存到文件，自动切</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">filename</span><span style="color: #800000;">'</span>: os.path.join(BASE_LOG_DIR, <span style="color: #800000;">"</span><span style="color: #800000;">xxx_err.log</span><span style="color: #800000;">"</span>),  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志文件</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">maxBytes</span><span style="color: #800000;">'</span>: 1024 * 1024 * 5,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志大小 5M</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">backupCount</span><span style="color: #800000;">'</span>: 5<span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">standard</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">encoding</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        },
        </span><span style="color: #008000;">#</span><span style="color: #008000;">打印到文件的日志</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">collect</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">INFO</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">class</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">logging.handlers.RotatingFileHandler</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">#</span><span style="color: #008000;"> 保存到文件，自动切</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">filename</span><span style="color: #800000;">'</span>: os.path.join(BASE_LOG_DIR, <span style="color: #800000;">"</span><span style="color: #800000;">xxx_collect.log</span><span style="color: #800000;">"</span><span style="color: #000000;">),
            </span><span style="color: #800000;">'</span><span style="color: #800000;">maxBytes</span><span style="color: #800000;">'</span>: 1024 * 1024 * 5,  <span style="color: #008000;">#</span><span style="color: #008000;"> 日志大小 5M</span>
            <span style="color: #800000;">'</span><span style="color: #800000;">backupCount</span><span style="color: #800000;">'</span>: 5<span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">formatter</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">collect</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">encoding</span><span style="color: #800000;">'</span>: <span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span><span style="color: #000000;">
        }
    },
    </span><span style="color: #800000;">'</span><span style="color: #800000;">loggers</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #008000;">#</span><span style="color: #008000;">logging.getLogger(__name__)拿到的logger配置</span>
        <span style="color: #800000;">''</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">error</span><span style="color: #800000;">'</span><span style="color: #000000;">],
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">DEBUG</span><span style="color: #800000;">'</span><span style="color: #000000;">,
            </span><span style="color: #800000;">'</span><span style="color: #800000;">propagate</span><span style="color: #800000;">'</span><span style="color: #000000;">: True,
        },
        </span><span style="color: #008000;">#</span><span style="color: #008000;">logging.getLogger('collect')拿到的logger配置</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">collect</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
            </span><span style="color: #800000;">'</span><span style="color: #800000;">handlers</span><span style="color: #800000;">'</span>: [<span style="color: #800000;">'</span><span style="color: #800000;">console</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">collect</span><span style="color: #800000;">'</span><span style="color: #000000;">],
            </span><span style="color: #800000;">'</span><span style="color: #800000;">level</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">INFO</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        }
    },
}


</span><span style="color: #008000;">#</span><span style="color: #008000;"> -----------</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 用法:拿到俩个logger</span>
<span style="color: #000000;">
logger </span>= logging.getLogger(<span style="color: #800080;">__name__</span>) <span style="color: #008000;">#</span><span style="color: #008000;">线上正常的日志</span>
collect_logger = logging.getLogger(<span style="color: #800000;">"</span><span style="color: #800000;">collect</span><span style="color: #800000;">"</span>) <span style="color: #008000;">#</span><span style="color: #008000;">领导说,需要为领导们单独定制领导们看的日志</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h1>十三 re模块</h1>
<p>一：什么是正则？</p>
<p>　<strong>正则就是用一些具有特殊含义的符号组合到一起（称为正则表达式）来描述字符或者字符串的方法。或者说：正则就是用来描述一类事物的规则。</strong><strong>（在Python中）它内嵌在Python中，并通过 re 模块实现。正则表达式模式被编译成一系列的字节码，然后由用 C 编写的匹配引擎执行。</strong></p>
<p><strong>生活中处处都是正则：</strong></p>
<p><strong>&nbsp; &nbsp; 比如我们描述：4条腿</strong></p>
<p><strong>&nbsp; &nbsp;&nbsp;　　你可能会想到的是四条腿的动物或者桌子，椅子等</strong></p>
<p><strong>&nbsp; &nbsp; 继续描述：4条腿，活的</strong></p>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 就只剩下四条腿的动物这一类了</strong></p>
<p>二：常用匹配模式(元字符)</p>
<p>http://blog.csdn.net/yufenghyc/article/details/51078107</p>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201705/1036857-20170529203214461-666088398.png" alt="" /></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;"> =================================匹配模式=================================</span><span style="color: #008000;">
#</span><span style="color: #008000;">一对一的匹配</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 'hello'.replace(old,new)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 'hello'.find('pattern')</span>

<span style="color: #008000;">#</span><span style="color: #008000;">正则匹配</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> re
</span><span style="color: #008000;">#</span><span style="color: #008000;">\w与\W</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\w</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['h', 'e', 'l', 'l', 'o', 'e', 'g', 'o', 'n', '1', '2', '3']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\W</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[' ', ' ']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\s与\S</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\s</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello  egon  123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[' ', ' ', ' ', ' ']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\S</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello  egon  123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['h', 'e', 'l', 'l', 'o', 'e', 'g', 'o', 'n', '1', '2', '3']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\n \t都是空,都可以被\s匹配</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\s</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello \n egon \t 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[' ', '\n', ' ', ' ', '\t', ' ']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\n与\t</span>
<span style="color: #0000ff;">print</span>(re.findall(r<span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon \n123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['\n']</span>
<span style="color: #0000ff;">print</span>(re.findall(r<span style="color: #800000;">'</span><span style="color: #800000;">\t</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon\t123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['\n']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\d与\D</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\d</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['1', '2', '3']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\D</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['h', 'e', 'l', 'l', 'o', ' ', 'e', 'g', 'o', 'n', ' ']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\A与\Z</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\Ahe</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['he'],\A==&gt;^</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">123\Z</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['he'],\Z==&gt;$</span>

<span style="color: #008000;">#</span><span style="color: #008000;">^与$</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">^h</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['h']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">3$</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">hello egon 123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['3']</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 重复匹配：| . | * | ? | .* | .*? | + | {n,m} |</span><span style="color: #008000;">
#</span><span style="color: #008000;">.</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a1b']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a b aaab</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a1b', 'a*b', 'a b', 'aab']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a\nb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a\nb</span><span style="color: #800000;">'</span>,re.S)) <span style="color: #008000;">#</span><span style="color: #008000;">['a\nb']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a\nb</span><span style="color: #800000;">'</span>,re.DOTALL)) <span style="color: #008000;">#</span><span style="color: #008000;">['a\nb']同上一条意思一样</span>

<span style="color: #008000;">#</span><span style="color: #008000;">*</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab*</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">bbbbbbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab*</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab*</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['abbbb']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">?</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab?</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab?</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['ab']</span><span style="color: #008000;">
#</span><span style="color: #008000;">匹配所有包含小数在内的数字</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\d+\.?\d*</span><span style="color: #800000;">'</span>,<span style="color: #800000;">"</span><span style="color: #800000;">asdfasdf123as1.13dfa12adsf1asdf3</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['123', '1.13', '12', '1', '3']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">.*默认为贪婪匹配</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.*b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b22222222b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a1b22222222b']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">.*?为非贪婪匹配：推荐使用</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a.*?b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b22222222b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['a1b']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">+</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab+</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab+</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['abbb']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">{n,m}</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab{2}</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['abb']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab{2,4}</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['abb']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab{1,}</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">'ab{1,}' ===&gt; 'ab+'</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab{0,}</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abbb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">'ab{0,}' ===&gt; 'ab*'</span>

<span style="color: #008000;">#</span><span style="color: #008000;">[]</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a[1*-]b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a-b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]内的都为普通字符了，且如果-没有被转意的话，应该放到[]的开头或结尾</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a[^1*-]b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a-b a=b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]内的^代表的意思是取反，所以结果为['a=b']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a[0-9]b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a-b a=b</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]内的^代表的意思是取反，所以结果为['a=b']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a[a-z]b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a-b a=b aeb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]内的^代表的意思是取反，所以结果为['a=b']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a[a-zA-Z]b</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a1b a*b a-b a=b aeb aEb</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">[]内的^代表的意思是取反，所以结果为['a=b']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">\# print(re.findall('a\\c','a\c')) #对于正则来说a\\c确实可以匹配到a\c,但是在python解释器读取a\\c时，会发生转义，然后交给re去执行，所以抛出异常</span>
<span style="color: #0000ff;">print</span>(re.findall(r<span style="color: #800000;">'</span><span style="color: #800000;">a\\c</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a\c</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">r代表告诉解释器使用rawstring，即原生字符串，把我们正则内的所有符号都当普通字符处理，不要转义</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">a\\\\c</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a\c</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">同上面的意思一样，和上面的结果一样都是['a\\c']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">():分组</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">ab+</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">ababab123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['ab', 'ab', 'ab']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">(ab)+123</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">ababab123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['ab']，匹配到末尾的ab123中的ab</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">(?:ab)+123</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">ababab123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">findall的结果不是匹配的全部内容，而是组内的内容,?:可以让结果为匹配的全部内容</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">href="(.*?)"</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">&lt;a href="http://www.baidu.com"&gt;点击&lt;/a&gt;</span><span style="color: #800000;">'</span>))<span style="color: #008000;">#</span><span style="color: #008000;">['http://www.baidu.com']</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">href="(?:.*?)"</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">&lt;a href="http://www.baidu.com"&gt;点击&lt;/a&gt;</span><span style="color: #800000;">'</span>))<span style="color: #008000;">#</span><span style="color: #008000;">['href="http://www.baidu.com"']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">|</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">compan(?:y|ies)</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">Too many companies have gone bankrupt, and the next one is my company</span><span style="color: #800000;">'</span>))</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;"># ===========================</span><span style="color: #008000;">re模块提供的方法介绍===========================</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> re
</span><span style="color: #008000;">#</span><span style="color: #008000;">1</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">e</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>) )   <span style="color: #008000;">#</span><span style="color: #008000;">['e', 'e', 'e'],返回所有满足匹配条件的结果,放在列表里</span><span style="color: #008000;">
#</span><span style="color: #008000;">2</span>
<span style="color: #0000ff;">print</span>(re.search(<span style="color: #800000;">'</span><span style="color: #800000;">e</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>).group()) <span style="color: #008000;">#</span><span style="color: #008000;">e,只到找到第一个匹配然后返回一个包含匹配信息的对象,该对象可以通过调用group()方法得到匹配的字符串,如果字符串没有匹配，则返回None。</span>

<span style="color: #008000;">#</span><span style="color: #008000;">3</span>
<span style="color: #0000ff;">print</span>(re.match(<span style="color: #800000;">'</span><span style="color: #800000;">e</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>))    <span style="color: #008000;">#</span><span style="color: #008000;">None,同search,不过在字符串开始处进行匹配,完全可以用search+^代替match</span>

<span style="color: #008000;">#</span><span style="color: #008000;">4</span>
<span style="color: #0000ff;">print</span>(re.split(<span style="color: #800000;">'</span><span style="color: #800000;">[ab]</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">abcd</span><span style="color: #800000;">'</span>))     <span style="color: #008000;">#</span><span style="color: #008000;">['', '', 'cd']，先按'a'分割得到''和'bcd',再对''和'bcd'分别按'b'分割</span>

<span style="color: #008000;">#</span><span style="color: #008000;">5</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">===&gt;</span><span style="color: #800000;">'</span>,re.sub(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">A</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">===&gt; Alex mAke love，不指定n，默认替换所有</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">===&gt;</span><span style="color: #800000;">'</span>,re.sub(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">A</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>,1)) <span style="color: #008000;">#</span><span style="color: #008000;">===&gt; Alex make love</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">===&gt;</span><span style="color: #800000;">'</span>,re.sub(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">A</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>,2)) <span style="color: #008000;">#</span><span style="color: #008000;">===&gt; Alex mAke love</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">===&gt;</span><span style="color: #800000;">'</span>,re.sub(<span style="color: #800000;">'</span><span style="color: #800000;">^(\w+)(.*?\s)(\w+)(.*?\s)(\w+)(.*?)$</span><span style="color: #800000;">'</span>,r<span style="color: #800000;">'</span><span style="color: #800000;">\5\2\3\4\1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">===&gt; love make alex</span>

<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">===&gt;</span><span style="color: #800000;">'</span>,re.subn(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">A</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">alex make love</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">===&gt; ('Alex mAke love', 2),结果带有总共替换的个数</span>


<span style="color: #008000;">#</span><span style="color: #008000;">6</span>
obj=re.compile(<span style="color: #800000;">'</span><span style="color: #800000;">\d{2}</span><span style="color: #800000;">'</span><span style="color: #000000;">)

</span><span style="color: #0000ff;">print</span>(obj.search(<span style="color: #800000;">'</span><span style="color: #800000;">abc123eeee</span><span style="color: #800000;">'</span>).group()) <span style="color: #008000;">#</span><span style="color: #008000;">12</span>
<span style="color: #0000ff;">print</span>(obj.findall(<span style="color: #800000;">'</span><span style="color: #800000;">abc123eeee</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['12'],重用了obj</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('97d0da9b-129c-4eeb-9b6c-6c10706e4d73')"><img id="code_img_closed_97d0da9b-129c-4eeb-9b6c-6c10706e4d73" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_97d0da9b-129c-4eeb-9b6c-6c10706e4d73" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('97d0da9b-129c-4eeb-9b6c-6c10706e4d73',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_97d0da9b-129c-4eeb-9b6c-6c10706e4d73" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> re
</span><span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">"</span><span style="color: #800000;">&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">&lt;h1&gt;hello&lt;/h1&gt;</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['h1']</span>
<span style="color: #0000ff;">print</span>(re.search(<span style="color: #800000;">"</span><span style="color: #800000;">&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">&lt;h1&gt;hello&lt;/h1&gt;</span><span style="color: #800000;">"</span>).group()) <span style="color: #008000;">#</span><span style="color: #008000;">&lt;h1&gt;hello&lt;/h1&gt;</span>
<span style="color: #0000ff;">print</span>(re.search(<span style="color: #800000;">"</span><span style="color: #800000;">&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">&lt;h1&gt;hello&lt;/h1&gt;</span><span style="color: #800000;">"</span>).groupdict()) <span style="color: #008000;">#</span><span style="color: #008000;">&lt;h1&gt;hello&lt;/h1&gt;</span>

<span style="color: #0000ff;">print</span>(re.search(r<span style="color: #800000;">"</span><span style="color: #800000;">&lt;(\w+)&gt;\w+&lt;/(\w+)&gt;</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">&lt;h1&gt;hello&lt;/h1&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">).group())
</span><span style="color: #0000ff;">print</span>(re.search(r<span style="color: #800000;">"</span><span style="color: #800000;">&lt;(\w+)&gt;\w+&lt;/\1&gt;</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">&lt;h1&gt;hello&lt;/h1&gt;</span><span style="color: #800000;">"</span>).group())</pre>
</div>
<span class="cnblogs_code_collapse">补充一</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('c125465e-d44b-49c3-b6db-b5acc51a1c47')"><img id="code_img_closed_c125465e-d44b-49c3-b6db-b5acc51a1c47" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_c125465e-d44b-49c3-b6db-b5acc51a1c47" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('c125465e-d44b-49c3-b6db-b5acc51a1c47',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_c125465e-d44b-49c3-b6db-b5acc51a1c47" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> re

</span><span style="color: #0000ff;">print</span>(re.findall(r<span style="color: #800000;">'</span><span style="color: #800000;">-?\d+\.?\d*</span><span style="color: #800000;">'</span>,<span style="color: #800000;">"</span><span style="color: #800000;">1-12*(60+(-40.35/5)-(-4*3))</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">找出所有数字['1', '-12', '60', '-40.35', '5', '-4', '3']</span>


<span style="color: #008000;">#</span><span style="color: #008000;">使用|，先匹配的先生效，|左边是匹配小数，而findall最终结果是查看分组，所有即使匹配成功小数也不会存入结果</span><span style="color: #008000;">
#</span><span style="color: #008000;">而不是小数时，就去匹配(-?\d+)，匹配到的自然就是，非小数的数，在此处即整数</span>
<span style="color: #0000ff;">print</span>(re.findall(r<span style="color: #800000;">"</span><span style="color: #800000;">-?\d+\.\d*|(-?\d+)</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">1-2*(60+(-40.35/5)-(-4*3))</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">找出所有整数['1', '-2', '60', '', '5', '-4', '3']</span></pre>
</div>
<span class="cnblogs_code_collapse">补充二</span></div>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">计算器作业参考：http://www.cnblogs.com/wupeiqi/articles/4949995.html</span>
expression=<span style="color: #800000;">'</span><span style="color: #800000;">1-2*((60+2*(-3-40.0/5)*(9-2*5/3+7/3*99/4*2998+10*568/14))-(-4*3)/(16-3*2))</span><span style="color: #800000;">'</span><span style="color: #000000;">

content</span>=re.search(<span style="color: #800000;">'</span><span style="color: #800000;">\(([\-\+\*\/]*\d+\.?\d*)+\)</span><span style="color: #800000;">'</span>,expression).group() <span style="color: #008000;">#</span><span style="color: #008000;">(-3-40.0/5)</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('105c8e28-0cd6-464b-8243-88ea33951151')"><img id="code_img_closed_105c8e28-0cd6-464b-8243-88ea33951151" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_105c8e28-0cd6-464b-8243-88ea33951151" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('105c8e28-0cd6-464b-8243-88ea33951151',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_105c8e28-0cd6-464b-8243-88ea33951151" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">为何同样的表达式search与findall却有不同结果:</span>
<span style="color: #0000ff;">print</span>(re.search(<span style="color: #800000;">'</span><span style="color: #800000;">\(([\+\-\*\/]*\d+\.?\d*)+\)</span><span style="color: #800000;">'</span>,<span style="color: #800000;">"</span><span style="color: #800000;">1-12*(60+(-40.35/5)-(-4*3))</span><span style="color: #800000;">"</span>).group()) <span style="color: #008000;">#</span><span style="color: #008000;">(-40.35/5)</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">\(([\+\-\*\/]*\d+\.?\d*)+\)</span><span style="color: #800000;">'</span>,<span style="color: #800000;">"</span><span style="color: #800000;">1-12*(60+(-40.35/5)-(-4*3))</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">['/5', '*3']</span>

<span style="color: #008000;">#</span><span style="color: #008000;">看这个例子:(\d)+相当于(\d)(\d)(\d)(\d)...,是一系列分组</span>
<span style="color: #0000ff;">print</span>(re.search(<span style="color: #800000;">'</span><span style="color: #800000;">(\d)+</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">123</span><span style="color: #800000;">'</span>).group()) <span style="color: #008000;">#</span><span style="color: #008000;">group的作用是将所有组拼接到一起显示出来</span>
<span style="color: #0000ff;">print</span>(re.findall(<span style="color: #800000;">'</span><span style="color: #800000;">(\d)+</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">123</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">findall结果是组内的结果,且是最后一个组的结果</span></pre>
</div>
<span class="cnblogs_code_collapse">search与findall</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('045b4985-9f68-4d9a-8f5e-5d9279080082')"><img id="code_img_closed_045b4985-9f68-4d9a-8f5e-5d9279080082" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_045b4985-9f68-4d9a-8f5e-5d9279080082" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('045b4985-9f68-4d9a-8f5e-5d9279080082',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_045b4985-9f68-4d9a-8f5e-5d9279080082" class="cnblogs_code_hide">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">_*_coding:utf-8_*_</span>
<span style="color: #800080;">__author__</span> = <span style="color: #800000;">'</span><span style="color: #800000;">Linhaifeng</span><span style="color: #800000;">'</span>
<span style="color: #008000;">#</span><span style="color: #008000;">在线调试工具:tool.oschina.net/regex/#</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> re

s</span>=<span style="color: #800000;">'''</span><span style="color: #800000;">
http://www.baidu.com
egon@oldboyedu.com
你好
010-3141
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;">最常规匹配</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Hello 123 456 World_This is a Regex Demo'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> res=re.match('Hello\s\d\d\d\s\d{3}\s\w{10}.*Demo',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group())</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.span())</span>

<span style="color: #008000;">#</span><span style="color: #008000;">泛匹配</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Hello 123 456 World_This is a Regex Demo'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> res=re.match('^Hello.*Demo',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group())</span>


<span style="color: #008000;">#</span><span style="color: #008000;">匹配目标,获得指定数据</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> content='Hello 123 456 World_This is a Regex Demo'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> res=re.match('^Hello\s(\d+)\s(\d+)\s.*Demo',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group()) #取所有匹配的内容</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(1)) #取匹配的第一个括号内的内容</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(2)) #去陪陪的第二个括号内的内容</span>



<span style="color: #008000;">#</span><span style="color: #008000;">贪婪匹配:.*代表匹配尽可能多的字符</span><span style="color: #008000;">
#</span><span style="color: #008000;"> import re</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Hello 123 456 World_This is a Regex Demo'</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> res=re.match('^He.*(\d+).*Demo$',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(1)) #只打印6,因为.*会尽可能多的匹配,然后后面跟至少一个数字</span>


<span style="color: #008000;">#</span><span style="color: #008000;">非贪婪匹配:?匹配尽可能少的字符</span><span style="color: #008000;">
#</span><span style="color: #008000;"> import re</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Hello 123 456 World_This is a Regex Demo'</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> res=re.match('^He.*?(\d+).*Demo$',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(1)) #只打印6,因为.*会尽可能多的匹配,然后后面跟至少一个数字</span>


<span style="color: #008000;">#</span><span style="color: #008000;">匹配模式:.不能匹配换行符</span>
content=<span style="color: #800000;">'''</span><span style="color: #800000;">Hello 123456 World_This
is a Regex Demo
</span><span style="color: #800000;">'''</span>
<span style="color: #008000;">#</span><span style="color: #008000;"> res=re.match('He.*?(\d+).*?Demo$',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res) #输出None</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> res=re.match('He.*?(\d+).*?Demo$',content,re.S) #re.S让.可以匹配换行符</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(1))</span>


<span style="color: #008000;">#</span><span style="color: #008000;">转义:\</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> content='price is $5.00'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> res=re.match('price is $5.00',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res)</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> res=re.match('price is \$5\.00',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res)</span>


<span style="color: #008000;">#</span><span style="color: #008000;">总结:尽量精简,详细的如下</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 尽量使用泛匹配模式.*</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 尽量使用非贪婪模式:.*?</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 使用括号得到匹配目标:用group(n)去取得结果</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 有换行符就用re.S:修改模式</span>















<span style="color: #008000;">#</span><span style="color: #008000;">re.search:会扫描整个字符串,不会从头开始,找到第一个匹配的结果就会返回</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> import re</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Extra strings Hello 123 456 World_This is a Regex Demo Extra strings'</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> res=re.match('Hello.*?(\d+).*?Demo',content)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res) #输出结果为None</span>

<span style="color: #008000;">#
#</span><span style="color: #008000;"> import re</span><span style="color: #008000;">
#</span><span style="color: #008000;"> content='Extra strings Hello 123 456 World_This is a Regex Demo Extra strings'</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> res=re.search('Hello.*?(\d+).*?Demo',content) #</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(res.group(1)) #输出结果为</span>



<span style="color: #008000;">#</span><span style="color: #008000;">re.search:只要一个结果,匹配演练,</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> re
content</span>=<span style="color: #800000;">'''</span><span style="color: #800000;">
&lt;tbody&gt;
&lt;tr id="4766303201494371851675" class="even "&gt;&lt;td&gt;&lt;div class="hd"&gt;&lt;span class="num"&gt;1&lt;/span&gt;&lt;div class="rk "&gt;&lt;span class="u-icn u-icn-75"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="rank"&gt;&lt;div class="f-cb"&gt;&lt;div class="tt"&gt;&lt;a href="/song?id=476630320"&gt;&lt;img class="rpic" src="http://p1.music.126.net/Wl7T1LBRhZFg0O26nnR2iQ==/19217264230385030.jpg?param=50y50&amp;amp;quality=100"&gt;&lt;/a&gt;&lt;span data-res-id="476630320" "
# res=re.search('&lt;a\shref=.*?&lt;b\stitle="(.*?)".*?b&gt;',content)
# print(res.group(1))


#re.findall:找到符合条件的所有结果
# res=re.findall('&lt;a\shref=.*?&lt;b\stitle="(.*?)".*?b&gt;',content)
# for i in res:
#     print(i)



#re.sub:字符串替换
import re
content='Extra strings Hello 123 456 World_This is a Regex Demo Extra strings'

# content=re.sub('\d+','',content)
# print(content)


#用\1取得第一个括号的内容
#用法:将123与456换位置
# import re
# content='Extra strings Hello 123 456 World_This is a Regex Demo Extra strings'
#
# # content=re.sub('(Extra.*?)(\d+)(\s)(\d+)(.*?strings)',r'\1\4\3\2\5',content)
# content=re.sub('(\d+)(\s)(\d+)',r'\3\2\1',content)
# print(content)




# import re
# content='Extra strings Hello 123 456 World_This is a Regex Demo Extra strings'
#
# res=re.search('Extra.*?(\d+).*strings',content)
# print(res.group(1))


# import requests,re
# respone=requests.get('https://book.douban.com/').text

# print(respone)
# print('======'*1000)
# print('======'*1000)
# print('======'*1000)
# print('======'*1000)
# res=re.findall('&lt;li.*?cover.*?href="(.*?)".*?title="(.*?)"&gt;.*?more-meta.*?author"&gt;(.*?)&lt;/span.*?year"&gt;(.*?)&lt;/span.*?publisher"&gt;(.*?)&lt;/span.*?&lt;/li&gt;',respone,re.S)
# # res=re.findall('&lt;li.*?cover.*?href="(.*?)".*?more-meta.*?author"&gt;(.*?)&lt;/span.*?year"&gt;(.*?)&lt;/span.*?publisher"&gt;(.*?)&lt;/span&gt;.*?&lt;/li&gt;',respone,re.S)
#
#
# for i in res:
#     print('%s    %s    %s   %s' %(i[0].strip(),i[1].strip(),i[2].strip(),i[3].strip()))</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


		</div>
		<div class = "postDesc">posted @ <span id="post-date">2017-02-09 22:28</span> <a href='http://www.cnblogs.com/linhaifeng/'>linhaifeng</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>) &nbsp;<a href="https://i.cnblogs.com/EditArticles.aspx?postid=6384466" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(6384466);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=309331,cb_entryId=6384466,cb_blogApp=currentBlogApp,cb_blogUserGuid='66b39f18-c28a-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/2/9 22:28:00';loadViewCount(cb_entryId);var cb_postType=2;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<div id='cnblogs_c1' class='c_ad_block'></div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'></div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2018 linhaifeng
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<!--PageEndHtml Block Begin-->
<script language="javascript" type="text/javascript">
//生成目录索引列表
function GenerateContentList()
{
  var jquery_h3_list = $('#cnblogs_post_body h1,h2,h3,h4').not('.catListTitle').not('#blogTitle h1');//如果你的章节标题不是h4,只需要将这里的h4换掉即可
  if(jquery_h3_list.length>0)
  {
    var content = '<a name="_labelTop"></a>';
    content	+= '<div id="navCategory">';
    content	+= '<p style="font-size:25px"><b>阅读目录</b></p>';
    content	+= '<ul>';
    for(var i =1;i<jquery_h3_list.length;i++)
    {
       // 以下两行是回到顶部的功能
       // var go_to_top = '<div style="text-align: right"><a href="#_labelTop">回到顶部</a><a name="_label' + i + '"></a></div>';
       var go_to_top = '<div style="text-align: right"><a href="#_labelTop"></a><a name="_label' + i + '"></a></div>';
       $(jquery_h3_list[i]).before(go_to_top);
      var li_content = '<li><a href="#_label' + i + '"style="color: darkseagreen;text-decoration:none;font-size:18px">' + $(jquery_h3_list[i]).text() + '</a></li>';
      content += li_content;
    }
    content	+= '</ul>';
    content	+= '</div>';
    if($('#cnblogs_post_body').length != 0 )
    {
      $($('#cnblogs_post_body')[0]).prepend(content);
    }
  }	
}
GenerateContentList();
</script>
<!--PageEndHtml Block End-->
</body>
</html>
